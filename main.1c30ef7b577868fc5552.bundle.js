webpackJsonp([1],{"+tBu":function(t,e,n){"use strict";var r=n("/oeL"),s=n("6lRS");n.d(e,"a",function(){return d});var a=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},o=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},i=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},d=function(){function t(t,e){this.dialogRef=t,this.data=e,this.onLogin=new r.EventEmitter}return t.prototype.login=function(t){console.log("Logging in...");var e={email:this.email,password:this.password};this.onLogin.emit(e),this.data.consumer.login(e)},t}();a([n.i(r.Output)(),o("design:type",Object)],d.prototype,"onLogin",void 0),a([n.i(r.Input)(),o("design:type",Object)],d.prototype,"errorMsg",void 0),d=a([n.i(r.Component)({selector:"login-component",template:n("8Vg4"),styles:[n("dCN4")]}),i(1,n.i(r.Inject)(s.c)),o("design:paramtypes",["function"==typeof(c=void 0!==s.d&&s.d)&&c||Object,Object])],d);var c},0:function(t,e,n){t.exports=n("cDNt")},"0+Pn":function(t,e,n){"use strict";var r=n("/oeL"),s=n("bKpL"),a=(n.n(s),n("2LMR")),o=n("HAwn"),i=n("xrDH"),d=(n.n(i),n("PMtK")),c=n.n(d);n.d(e,"a",function(){return m});var u=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(){}return t.prototype.isAdmin=function(){return this.roles&&1==this.roles.admin},t.prototype.isUpdater=function(){return this.roles&&1==this.roles.updater},t.prototype.isFsgAssistant=function(t){return void 0===t&&(t=null),this.roles&&i.isEmpty(t)||i.isNull(t)?1==this.roles.fsgAssist:1==this.roles.fsgAssist&&1==this.roles.fsg[t]},t.prototype.isPublisher=function(){return this.roles&&1==this.roles.publisher},Object.defineProperty(t.prototype,"hasUserInfo",{get:function(){return this.roles&&this.userInfoObj},enumerable:!0,configurable:!0}),t}(),m=function(){function t(t,e){this.af=t,this.db=e,this.roleList=["admin","updater","fsgoverseer","publisher"],this.onCurrentUserInfo=new r.EventEmitter}return t.prototype.getUser=function(){return this.af.auth.currentUser},t.prototype.getUserObs=function(){return this.af.authState},t.prototype.isLoggedIn=function(){return null!=this.getUser()},t.prototype.onAuthChange=function(t){this.af.auth.onAuthStateChanged(t)},t.prototype.login=function(t,e){return this.af.auth.signInWithEmailAndPassword(t,e)},t.prototype.logout=function(){return this.af.auth.signOut()},t.prototype.getUserRole=function(t){return this.db.object("/roles/"+t.userObj.uid).flatMap(function(e){return t.roles=e,s.Observable.of(t)})},t.prototype.getUserInfo=function(t){return this.db.object("/users/"+t.userObj.uid).flatMap(function(e){return t.userInfoObj=e,s.Observable.of(t)})},t.prototype.getAllUserInfo=function(){var t=this;this.currentUser=new l,this.currentUser.userObj=this.getUser(),this.getUserRole(this.currentUser).flatMap(function(e){return t.getUserInfo(t.currentUser)}).subscribe(function(e){t.onCurrentUserInfo.emit(t.currentUser)})},t.prototype.getAllUsersList=function(){var t=this;return this.usersList?s.Observable.of(this.usersList):this.db.list("/users/list").flatMap(function(e){return t.usersList?t.usersList.length=0:t.usersList=[],s.Observable.from(e)}).flatMap(function(e){return t.db.object("/users/"+e.$value).flatMap(function(e){return i.remove(t.usersList,function(t){return t.$key==e.$key}),t.usersList.push(e),s.Observable.of(e)})}).debounceTime(300).flatMap(function(e){return s.Observable.of(t.usersList)})},t.prototype.sendPasswordReset=function(t,e){void 0===e&&(e=null),this.af.auth.sendPasswordResetEmail(t).then(function(){e&&e()})},t.prototype.createUser=function(t,e,n){this.db.object("/users/requests/pending/createUser/"+Date.now()).update({name:t,email:e,role:n})},t.prototype.saveLoc=function(t,e){this.db.object("/log/"+t+"/loc").update({lat:e.position.lat,lng:e.position.lng,date:c()().utcOffset("+10:00").toISOString(!0)})},t.prototype.saveOnlineStat=function(t){this.db.object("/log/"+t.userObj.uid+"/lastSeen").update({name:t.userInfoObj.name,date:c()().utcOffset("+10:00").toISOString(!0)})},t}();u([n.i(r.Output)(),p("design:type",Object)],m.prototype,"onCurrentUserInfo",void 0),m=u([n.i(r.Injectable)(),p("design:paramtypes",["function"==typeof(h=void 0!==a.a&&a.a)&&h||Object,"function"==typeof(f=void 0!==o.a&&o.a)&&f||Object])],m);var h,f},"0lQa":function(t,e){t.exports='<div mat-dialog-content>\r\n  <form name=\'selectUserForm\'>\r\n    <mat-card>\r\n      <mat-card-header>\r\n        <mat-card-title>\r\n          <h4>{{data.consumer.userSelectTitle}}</h4>\r\n        </mat-card-title>\r\n        <mat-card-subtitle>{{ data.consumer.userSelectDesc }}</mat-card-subtitle>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <tag-input [(ngModel)]="data.consumer.selectedUsers" name="selectUserDlg"\r\n           [editable]="true" [identifyBy]="\'id\'" [displayBy]="\'name\'"\r\n            [onlyFromAutocomplete]="true" [placeholder]="data.consumer.placeHolderTxt" [secondaryPlaceholder]="data.consumer.placeHolderTxt">\r\n           <tag-input-dropdown [appendToBody]="false" [autocompleteItems]=\'data.consumer.userList\' [identifyBy]="\'$key\'" [displayBy]="\'name\'"></tag-input-dropdown>\r\n        </tag-input>\r\n      </mat-card-content>\r\n    </mat-card>\r\n  </form>\r\n  <mat-dialog-actions>\r\n    <button mat-mini-fab (click)="data.consumer.sendResetPassword()"><mat-icon>save</mat-icon></button>\r\n    <button mat-mini-fab (click)="data.consumer.cancel()"><mat-icon>cancel</mat-icon></button>\r\n  </mat-dialog-actions>\r\n  <div>\r\n    {{data.consumer.errorMsg}}\r\n  </div>\r\n</div>\r\n'},"0o1w":function(t,e,n){"use strict";var r=n("/oeL"),s=n("GsmQ"),a=n("6lRS"),o=n("HGbW"),i=n("0+Pn"),d=n("Dcui"),c=n("PMtK"),u=n.n(c),p=n("xrDH");n.n(p);n.d(e,"a",function(){return f});var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},h=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=function(t){function e(e,n,r,s){var a=t.call(this)||this;return a.mapService=r,a.winRef=s,a.loaded=!1,a.hasMaps=!1,a.dialog=e,a.fireAuth=n,s.redirHttps(),a}return l(e,t),e.prototype.load=function(){var t=this;this.showLoadingDialog(),this.mapService.getMetadata().subscribe(function(e){t.metadata=e,t.fireAuth.currentUser.isAdmin()||t.fireAuth.currentUser.isUpdater()?(console.log("Loading current maps..."),t.getAllMapsList()):t.fireAuth.currentUser.isFsgAssistant()?t.getFsgMaps():t.getAllUserMaps(),t.loadPreferences(),t.subs.push(t.fireAuth.getAllUsersList().subscribe(function(t){console.log("User list pre-loaded..")}))})},e.prototype.getOverallCompletion=function(){return this.metadata.mode.campaign?this.metadata.report.campaign.currentCompletion:this.metadata.report.regular.currentCompletion},e.prototype.getMapCount=function(){return this.metadata.mode.campaign?this.metadata.report.campaign.mapCount:this.metadata.report.regular.mapCount},e.prototype.getCompletionReport=function(){return this.metadata.mode.campaign?this.metadata.report.campaign:this.metadata.report.regular},e.prototype.getFsgMaps=function(){p.forOwn(this.fireAuth.currentUser.roles.fsg,function(t,e){})},e.prototype.getAllUserMaps=function(){var t=this;console.log("Getting all user maps..."),this.subs.push(this.mapService.getUserMaps(this.fireAuth.currentUser).subscribe(function(e){console.log("Got all user maps..."),p.forEach(e,function(n,r){if(p.remove(n.maps,function(e){return!e.isUser(t.fireAuth.currentUser)}),0==n.maps.length&&e.length>0&&e.splice(r,1),t.fsgMaps){var s=p.find(t.fsgMaps,function(t){return n.fsgName==t.fsgName});s&&(console.log("Match found:::"),console.log(s),console.log(n),s.metadata=n.metadata,s.maps=n.maps,s.completedMapsCtr=n.completedMapsCtr,s.completionRate=n.completionRate)}}),t.hasMaps=e&&e.length>0,t.fsgMaps||(t.fsgMaps=e),p.each(t.fsgMaps,function(t){t.maps=p.sortBy(t.maps,function(t){return p.toInteger(t.mapObj.terId)})}),t.hideLoadingDialog()}))},e.prototype.getFsgName=function(t){return"Your Maps"!=t.fsgName?t.fsgName+" "+(this.mapService.fsgHasCompletion(t.fsgName)?"- "+t.getCompletionPercent()+"%":""):t.fsgName},e.prototype.getAllMapsList=function(){var t=this;console.log("Getting all maps..."),this.hasMaps=!0,(this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())&&this.subs.push(this.mapService.getAllFsgMapsList(!0).flatMap(function(e){return p.each(e,function(e){e.computeCompleted(),e.expanded=!!t.compMap&&t.compMap[e.fsgName].fsg.expanded}),t.fsgMaps=e,console.log("All maps:"),console.log(e),t.mapService.getUserMaps(t.fireAuth.currentUser)}).subscribe(function(e){if(t.fsgMaps.length>0&&e.length>0){p.find(t.fsgMaps,function(t){return t.fsgName==e[0].fsgName})||(t.fsgMaps=e.concat(t.fsgMaps))}t.hideLoadingDialog()}))},e.prototype.getMapUsers=function(t){var e="";return p.forEach(t.getUsersList(),function(t){e=""+(p.isEmpty(e)?e:e+", ")+t.name}),e},e.prototype.toggleExpand=function(t,e){t.expanded=e},e.prototype.canOpenMap=function(t){return this.fireAuth.currentUser&&(t.isUser(this.fireAuth.currentUser)||this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e.prototype.getCompletionPercentage=function(t){return this.mapService.getCompletionPercentage(t)},e.prototype.getRemaining=function(t){return this.mapService.getRemainingAddresses(t)},e.prototype.isUpdater=function(){return this.fireAuth.currentUser&&(this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e.prototype.getBg=function(t,e){var n=u()(),r=u()(t),s=u()().add(3,"days"),a=u()().add(6,"days");return n.isSameOrAfter(r)||n.isBetween(s,r,null,"[]")?"pink":n.isBetween(a,r,null,"[]")?"yellow":"lightgray"},e.prototype.getBgMap=function(t){var e=t.mapObj.doneCtr;return this.isNormalMode()||(e=t.mapObj.campaignCtr),e>0?"lightgray":"white"},e.prototype.isNormalMode=function(){return this.mapService.isNormalMode()},e.prototype.loadPreferences=function(){var t=this;this.fireAuth.getUserInfo(this.fireAuth.currentUser).subscribe(function(e){if(e.userInfoObj.geo){var n=new r.EventEmitter,s=null;n.subscribe(function(e){var n=u()();null!=s&&n.isBefore(s.add(1,"minute"))||(s=n,t.fireAuth.saveLoc(t.fireAuth.currentUser.userObj.uid,e))}),t.mapService.enableGeolocation(n)}t.fireAuth.saveOnlineStat(t.fireAuth.currentUser)})},e.prototype.addFsgComp=function(t,e,n){this.compMap||(this.compMap={}),this.compMap[t.fsgName]||(this.compMap[t.fsgName]={comp:n,fsg:t},"Your Maps"==t.fsgName&&n.open())},e}(o.a);f=m([n.i(r.Component)({selector:"mapslist-component",template:n("ivJn"),styles:[n("Z2wb")]}),h("design:paramtypes",["function"==typeof(g=void 0!==a.b&&a.b)&&g||Object,"function"==typeof(b=void 0!==i.a&&i.a)&&b||Object,"function"==typeof(y=void 0!==s.a&&s.a)&&y||Object,"function"==typeof(v=void 0!==d.a&&d.a)&&v||Object])],f);var g,b,y,v},"3CHR":function(t,e){t.exports='<mat-toolbar [ngClass]="\'bgc-blue-grey-900 whiteText marginTopBottom-2\'">\r\n  <span><h3>{{title}}</h3></span>\r\n  <span class="fill-remaining-space"></span>\r\n  \x3c!-- <span><button mat-mini-fab (click)="startMap()" *ngIf="currentMap" style="margin-right: 10px;"><mat-icon>play_arrow</mat-icon></button></span> --\x3e\r\n  <span>\r\n    <button *ngIf="mapId != \'all\' && isUpdater() && !isEditModeMoveAddress()" mat-mini-fab (click)="addNewAddressMode()" style="margin-right: 5px;" >\r\n      <mat-icon>add_location</mat-icon>\r\n    </button>\r\n    <button *ngIf="mapId != \'all\' && isUpdater() && !isEditModeMoveAddress() && !mapStarted && !isEditModeNeedAddress()" mat-mini-fab (click)="startMoveAddressMode()" style="margin-right: 5px;" >\r\n      <mat-icon>transform</mat-icon>\r\n    </button>\r\n    <button *ngIf="isUpdater() && isEditModeMoveAddress()" mat-mini-fab (click)="stopMoveAddressMode()" style="margin-right: 5px;" >\r\n      <mat-icon>cancel</mat-icon>\r\n    </button>\r\n    <button mat-mini-fab (click)="toggleShowLocation()" style="margin-right: 5px;" >\r\n      <mat-icon *ngIf="!showLocation">location_disabled</mat-icon>\r\n      <mat-icon *ngIf="showLocation && !locationSearching">my_location</mat-icon>\r\n      <mat-icon *ngIf="showLocation && locationSearching">location_searching</mat-icon>\r\n    </button>\r\n  </span>\r\n  <span><button mat-mini-fab (click)="fitMap()" ><mat-icon svgIcon="fit-map"></mat-icon></button></span>\r\n  <button mat-icon-button [matMenuTriggerFor]="menu" >\r\n    <mat-icon>more_vert</mat-icon>\r\n  </button>\r\n  <mat-menu #menu="matMenu" >\r\n    <button mat-menu-item (click)="viewList()" *ngIf="!isEditModeNeedAddress()">\r\n      <mat-icon>view_list</mat-icon>\r\n      <span>List View</span>\r\n    </button>\r\n    <a href="{{ addUrl }}" target="_blank" mat-menu-item>\r\n      <mat-icon svgIcon="add-address"></mat-icon>\r\n      <span>New Address</span>\r\n    </a>\r\n    <button mat-menu-item (click)="editMap()" *ngIf="isUpdater() && this.mapId != \'all\'">\r\n      <mat-icon>edit</mat-icon>\r\n      <span>Edit Map</span>\r\n    </button>\r\n    <button mat-menu-item (click)="deleteMap()" *ngIf="isUpdater() && this.mapId != \'all\'">\r\n      <mat-icon>delete_forever</mat-icon>\r\n      <span>Delete Map</span>\r\n    </button>\r\n    <a mat-menu-item [routerLink]="[\'/home\']" >\r\n      <mat-icon>home</mat-icon>\r\n      <span>Home</span>\r\n    </a>\r\n  </mat-menu>\r\n</mat-toolbar>\r\n<mat-card *ngIf="isEditModeMoveAddress() && this.selectedAddresses.length > 0">\r\n  <mat-card-title>Move Address(es)</mat-card-title>\r\n  <mat-card-content>\r\n    <p>\r\n      <mat-chip-list selectable="false">\r\n        <mat-chip *ngFor="let addr of selectedAddresses">{{ getAddressTitle(addr) }} </mat-chip>\r\n      </mat-chip-list>\r\n    </p>\r\n    <p>\r\n      <mat-form-field>\r\n        <input matInput placeholder="Move to Map ID" name="findMapId" [(ngModel)]="findMapId" required>\r\n      </mat-form-field>\r\n      <button mat-mini-fab (click)="findTargetMap()" style="margin-right: 5px;">\r\n        <mat-icon>search</mat-icon>\r\n      </button>\r\n    </p>\r\n    <p>\r\n      <span *ngIf="targetMapObj"> Moving to map: {{ targetMapObj.terId }} - {{ targetMapObj.name }} </span>\r\n    </p>\r\n  </mat-card-content>\r\n  <mat-card-actions>\r\n    <button [disabled]="!targetMapObj" mat-mini-fab (click)="moveSelectedAddresses()" style="margin-right: 5px;" >\r\n      <mat-icon>save</mat-icon>\r\n    </button>\r\n    <button mat-mini-fab (click)="stopMoveAddressMode()" style="margin-right: 5px;" >\r\n      <mat-icon>cancel</mat-icon>\r\n    </button>\r\n  </mat-card-actions>\r\n</mat-card>\r\n\x3c!-- <mat-toolbar [ngClass]="\'bgc-yellow-100 marginTopBottom-2\'" *ngIf="isAdmin()">\r\n  <span><mat-button-toggle style="margin-right: 10px;" (change)="toggleShowInfo($event)"><mat-icon>info</mat-icon></mat-button-toggle></span>\r\n  <span class="fill-remaining-space"></span>\r\n</mat-toolbar> --\x3e\r\n<agm-map [latitude]="centerLat" [longitude]="centerLng" [zoom]="zoom" [ngStyle]="{\'height\': height}">\r\n  <marker-cluster #markerCluster [onLoadComplete]="onMarkerLoad" [onAddLocMarker]="onAddLocMarker" [onFit]="onFit" [minimumClusterSize]="minimumClusterSize" [onAddressClick]="onAddressClick" [onUpdate]="mapService.onUpdate" [onSetShowClusterInfo]="onToggleShowInfo" [points]="points" ></marker-cluster>\r\n</agm-map>\r\n'},"4wwY":function(t,e){t.exports='<div style="text-align:center">\r\n  <h2>\r\n    {{ appTitle }}\r\n  </h2>\r\n</div>\r\n<div>\r\n   <mat-toolbar [ngClass]="\'bgc-blue-grey-900 whiteText marginTopBottom-2\'">\r\n      <userinfo></userinfo>\r\n      <span class="fill-remaining-space"></span>\r\n      <span><a style="margin-right: 5px;" mat-mini-fab [routerLink]="[\'/home\']" ><mat-icon >home</mat-icon></a></span>\r\n      <user-admin></user-admin>\r\n   </mat-toolbar>\r\n</div>\r\n<mat-tab-group >\r\n  \x3c!-- <mat-tab label="Search">\r\n    <map-search></map-search>\r\n  </mat-tab> --\x3e\r\n  <mat-tab label="Add Data">\r\n    <mat-radio-group class="radio-group" [(ngModel)]="newDataType" >\r\n      <mat-radio-button value="fsg" class="radio-button">FSG</mat-radio-button>\r\n      <mat-radio-button value="map" class="radio-button">Map</mat-radio-button>\r\n      \x3c!-- <mat-radio-button value="[(ngModel)]="newDataType" address" class="radio-button">Address</mat-radio-button> --\x3e\r\n    </mat-radio-group>\r\n    \x3c!-- --\x3e\r\n    <div *ngIf="newDataType == \'fsg\'" style="padding: 10px;">\r\n      <mat-form-field >\r\n        <input matInput placeholder="New FSG name" [(ngModel)]="fsgName">\r\n      </mat-form-field>\r\n    </div>\r\n\r\n    <div *ngIf="newDataType == \'map\'" style="padding: 10px;">\r\n      <mat-form-field >\r\n        <input matInput placeholder="New Map Name" [(ngModel)]="mapName">\r\n      </mat-form-field>\r\n      <mat-form-field>\r\n        <mat-select placeholder="FSG" [(value)]="fsgName">\r\n            <mat-option *ngFor="let fsg of fsgs" [value]="fsg">\r\n              {{fsg}}\r\n            </mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n    </div>\r\n\r\n    <div  style="padding: 10px;">\r\n      <button mat-raised-button color="primary" *ngIf="newDataType != null" (click)="saveNewData()">Save</button>\r\n      <div *ngIf="msg">{{ msg }}</div>\r\n    </div>\r\n  </mat-tab>\r\n\r\n  <mat-tab label="Search Address">\r\n    <form (ngSubmit)="searchData()">\r\n      \x3c!-- <mat-radio-group class="radio-group" [(ngModel)]="searchDataType" >\r\n        <mat-radio-button value="address" class="radio-button">Address</mat-radio-button>\r\n      </mat-radio-group> --\x3e\r\n\r\n      <div *ngIf="searchDataType == \'address\'" style="padding: 10px; width:100%">\r\n        <mat-form-field style="width: 400px;">\r\n          <input matInput placeholder="Street Name (first few letters)" [(ngModel)]="stName" [ngModelOptions]="{standalone: true}" [disabled]="isBusy">\r\n        </mat-form-field>\r\n        <button type="submit" mat-raised-button color="primary" *ngIf="searchDataType != null" (click)="searchData()" [disabled]="isBusy" >Search</button>\r\n      </div>\r\n\r\n      <div  style="padding: 10px;">\r\n        <div *ngIf="msg">{{ msg }}</div>\r\n      </div>\r\n\r\n      <table *ngIf="searchRes && searchRes.length > 0" >\r\n        <thead>\r\n          <tr>\r\n            <td> Address </td>\r\n            <td> Suburb </td>\r\n            <td> Map </td>\r\n            <td> FSG </td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr *ngFor="let elem of searchRes">\r\n            <td> {{ elem.fullSt }} </td>\r\n            <td> {{ elem.burb }} </td>\r\n            <td> <a [routerLink]="[\'/map\', elem.mapId]" target="_blank"> {{ elem.map }} </a> </td>\r\n            <td> {{ elem.fsg }} </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      \x3c!-- <table mat-table [dataSource]="searchRes" class="mat-elevation-z8">\r\n        <ng-container matColumnDef="fullSt">\r\n          <th mat-header-cell *matHeaderCellDef> Address </th>\r\n          <td mat-cell *matCellDef="let element"> {{element.fullSt }} </td>\r\n        </ng-container>\r\n        <ng-container matColumnDef="burb">\r\n          <th mat-header-cell *matHeaderCellDef> Suburb </th>\r\n          <td mat-cell *matCellDef="let element"> {{element.burb }} </td>\r\n        </ng-container>\r\n        <ng-container matColumnDef="map">\r\n          <th mat-header-cell *matHeaderCellDef> Map </th>\r\n          <td mat-cell *matCellDef="let element"> {{element.map }} </td>\r\n        </ng-container>\r\n        <ng-container matColumnDef="fsg">\r\n          <th mat-header-cell *matHeaderCellDef> FSG </th>\r\n          <td mat-cell *matCellDef="let element"> {{element.fsg }} </td>\r\n        </ng-container>\r\n\r\n        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>\r\n        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>\r\n      </table> --\x3e\r\n    </form>\r\n  </mat-tab>\r\n\r\n</mat-tab-group>\r\n'},"5OgQ":function(t,e){t.exports='<div mat-dialog-content>\r\n      <span><h3> Edit Map </h3></span>\r\n        <mat-card>\r\n          <mat-card-content>\r\n            <div>\r\n              <mat-form-field style="width: 300px;">\r\n                <input matInput placeholder="Map Name" [(ngModel)]="data.consumer.mapName" [ngModelOptions]="{standalone: true}" >\r\n              </mat-form-field>\r\n            </div>\r\n            <div>\r\n              <mat-form-field>\r\n                <mat-select placeholder="FSG" [(value)]="data.consumer.fsgName">\r\n                    <mat-option *ngFor="let fsg of data.consumer.fsgs" [value]="fsg">\r\n                      {{fsg}}\r\n                    </mat-option>\r\n                </mat-select>\r\n              </mat-form-field>\r\n            </div>\r\n          </mat-card-content>\r\n          <mat-card-actions>\r\n            <button mat-fab (click)="data.consumer.saveMapEdit()" ><mat-icon>save</mat-icon></button>\r\n            <button mat-fab (click)="data.consumer.closeMapEditDlg()"><mat-icon>cancel</mat-icon></button>\r\n          </mat-card-actions>\r\n        </mat-card>\r\n\r\n      <mat-dialog-actions>\r\n      </mat-dialog-actions>\r\n</div>\r\n'},"76ka":function(t,e,n){"use strict";var r=n("/oeL"),s=n("0+Pn"),a=n("HGbW"),o=n("xrDH"),i=(n.n(o),n("6lRS")),d=n("p5Ee");n.d(e,"a",function(){return m}),n.d(e,"b",function(){return h}),n.d(e,"c",function(){return f}),n.d(e,"d",function(){return g});var c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},m=function(t){function e(e,n){var r=t.call(this)||this;return r.fireAuth=e,r.dialog=n,r.subs=[],r}return c(e,t),e.prototype.ngOnInit=function(){var t=this;this.user=this.fireAuth.currentUser,this.subs.push(this.fireAuth.onCurrentUserInfo.subscribe(function(e){t.user=t.fireAuth.currentUser})),this.userList||this.subs.push(this.fireAuth.getAllUsersList().subscribe(function(e){t.userList=e}))},e.prototype.isUpdater=function(){return this.user&&(this.user.isAdmin()||this.user.isUpdater())},e.prototype.resetPassword=function(){this.userSelectTitle="User Password Reset",this.userSelectDesc="Type the names of users",this.placeHolderTxt="Publisher name",this.showDlg()},e.prototype.addUser=function(){this.userSelectTitle="Create New User",this.userSelectDesc="Provide new user/publisher details",this.newUser={name:"",email:"",role:"publisher"},this.showUserDlg()},e.prototype.showDlg=function(){this.currentDlg||(this.currentDlg=this.dialog.open(h,{data:{consumer:this},disableClose:!0}))},e.prototype.showUserDlg=function(){this.currentDlg||(this.currentDlg=this.dialog.open(f,{data:{consumer:this},disableClose:!0}))},e.prototype.showVersionDlg=function(){this.currentDlg||(this.currentDlg=this.dialog.open(g,{data:{consumer:this},disableClose:!0}))},e.prototype.getVersions=function(){var t=[];return o.each(d.a.version.list,function(e){t.push({versionNum:e,text:d.a.version.details[e]})}),t},e.prototype.closeDlg=function(){this.dialog.closeAll(),this.currentDlg=null,this.selectedUsers=null},e.prototype.sendResetPassword=function(){var t=this;this.selectedUsers&&this.selectedUsers.length;o.forEach(this.selectedUsers,function(e){e.email?(console.log("Resetting: "),console.log(e),t.fireAuth.sendPasswordReset(e.email)):(console.log("No email:"),console.log(e))}),this.closeDlg()},e.prototype.createUser=function(){this.fireAuth.createUser(this.newUser.name,this.newUser.email,this.newUser.role),this.closeDlg()},e.prototype.cancel=function(){this.closeDlg()},e}(a.a);m=u([n.i(r.Component)({selector:"user-admin",template:n("l1II")}),p("design:paramtypes",["function"==typeof(b=void 0!==s.a&&s.a)&&b||Object,"function"==typeof(y=void 0!==i.b&&i.b)&&y||Object])],m);var h=function(){function t(t,e){this.dialogRef=t,this.data=e}return t}();h=u([n.i(r.Component)({selector:"selectuser-dlg",template:n("0lQa")}),l(1,n.i(r.Inject)(i.c)),p("design:paramtypes",["function"==typeof(v=void 0!==i.d&&i.d)&&v||Object,Object])],h);var f=function(){function t(t,e){this.dialogRef=t,this.data=e}return t}();f=u([n.i(r.Component)({selector:"selectuser-dlg",template:n("Sx8v")}),l(1,n.i(r.Inject)(i.c)),p("design:paramtypes",["function"==typeof(M=void 0!==i.d&&i.d)&&M||Object,Object])],f);var g=function(){function t(t,e){this.dialogRef=t,this.data=e}return t}();g=u([n.i(r.Component)({selector:"version-dlg",template:n("X0pD")}),l(1,n.i(r.Inject)(i.c)),p("design:paramtypes",["function"==typeof(O=void 0!==i.d&&i.d)&&O||Object,Object])],g);var b,y,v,M,O},"8Vg4":function(t,e){t.exports='<div mat-dialog-content>\r\n  <form name=\'loginFrm\' (submit)=\'login($event)\'>\r\n    <div class="flex-container"\r\n       fxLayout="column"\r\n       fxLayout.xs="column"\r\n       fxLayoutAlign="center center"\r\n       fxLayoutAlign.xs="start">\r\n       <div>\r\n        <div>\r\n          <mat-form-field>\r\n            <label>Email</label>\r\n            <input matInput type=\'email\' name="email" [(ngModel)]="email" >\r\n          </mat-form-field>\r\n        </div>\r\n        <div>\r\n          <mat-form-field>\r\n            <label>Password</label>\r\n            <input matInput type=\'password\' name="password" [(ngModel)]="password" >\r\n          </mat-form-field>\r\n        </div>\r\n        <mat-dialog-actions>\r\n          <button mat-button mat-raised-button type=\'submit\' [disabled]="isPending || isMaint" >Login</button>\r\n        </mat-dialog-actions>\r\n        <div>\r\n          {{data.consumer.errorMsg}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n'},APxZ:function(t,e){t.exports='<div mat-dialog-content>\r\n  <form name=\'shareForm\'>\r\n    <mat-card *ngIf="data.consumer.ownerMode">\r\n      <mat-card-header>\r\n        <mat-card-title>\r\n          <h4>{{data.consumer.ownerCardTitle}}</h4>\r\n        </mat-card-title>\r\n        <mat-card-subtitle>{{ data.consumer.ownerCardDesc }}</mat-card-subtitle>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <mat-checkbox [(ngModel)]="data.consumer.isPersonal" name="isPersonal" (click)="data.consumer.togglePersonal()">Personal Territory</mat-checkbox>\r\n        <tag-input [(ngModel)]="data.consumer.userList" name="ownerDlg"\r\n           [editable]="true" [identifyBy]="\'id\'" [displayBy]="\'name\'"\r\n           [maxItems]="1" [onlyFromAutocomplete]="true" [placeholder]="data.consumer.placeHolderTxt" [secondaryPlaceholder]="data.consumer.placeHolderTxt">\r\n           <tag-input-dropdown [appendToBody]="false" [autocompleteItems]=\'data.consumer.mapUsers\' [identifyBy]="\'$key\'" [displayBy]="\'name\'"></tag-input-dropdown>\r\n        </tag-input>\r\n        <mat-form-field>\r\n          <textarea matInput placeholder="Additional notes" matTextareaAutosize matAutosizeMinRows="1"\r\n           matAutosizeMaxRows="10" [(ngModel)]="data.consumer.notes" name="notes"></textarea>\r\n        </mat-form-field>\r\n        \x3c!-- <mat-form-field>\r\n           <input type="text" matInput name="selUser" [(ngModel)]="data.consumer.selUser"  [matAutocomplete]="autoPub">\r\n        </mat-form-field>\r\n        <mat-autocomplete #autoPub="matAutocomplete" [displayWith]="displayFn">\r\n           <mat-option *ngFor="let mapUser of data.consumer.mapUsers" [value]="mapUser">\r\n             {{ mapUser.userInfoObj.name }}\r\n           </mat-option>\r\n        </mat-autocomplete> --\x3e\r\n        \x3c!-- <button mat-mini-fab (click)="data.consumer.done()"><mat-icon>person_add</mat-icon></button> --\x3e\r\n      </mat-card-content>\r\n    </mat-card>\r\n    <mat-card *ngIf="!data.consumer.ownerMode">\r\n      <mat-card-header>\r\n        <mat-card-title>\r\n          <h4>{{data.consumer.shareCardTitle}}</h4>\r\n        </mat-card-title>\r\n        <mat-card-subtitle>{{ data.consumer.shareCardDesc }}</mat-card-subtitle>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <tag-input [(ngModel)]="data.consumer.userList" name="ownerDlg"\r\n           [editable]="true" [identifyBy]="\'id\'" [displayBy]="\'name\'" (onAdd)="data.consumer.onItemAdded($event)" (onRemove)="data.consumer.onItemRemove($event)"\r\n           [onlyFromAutocomplete]="true" [placeholder]="data.consumer.placeHolderTxt" [secondaryPlaceholder]="data.consumer.placeHolderTxt">\r\n           <tag-input-dropdown [appendToBody]="false" [autocompleteItems]=\'data.consumer.mapUsers\' [identifyBy]="\'$key\'" [displayBy]="\'name\'"></tag-input-dropdown>\r\n        </tag-input>\r\n      </mat-card-content>\r\n    </mat-card>\r\n  </form>\r\n  <mat-dialog-actions>\r\n    <button mat-mini-fab (click)="data.consumer.done()"><mat-icon>save</mat-icon></button>\r\n    <button mat-mini-fab (click)="data.consumer.cancel()"><mat-icon>cancel</mat-icon></button>\r\n  </mat-dialog-actions>\r\n  <div>\r\n    {{data.consumer.errorMsg}}\r\n  </div>\r\n</div>\r\n'},CKBp:function(t,e,n){"use strict";var r=n("/oeL"),s=n("GsmQ"),a=n("6lRS"),o=n("HGbW"),i=n("0+Pn"),d=n("Dcui"),c=n("PMtK"),u=n.n(c),p=n("xrDH");n.n(p);n.d(e,"a",function(){return g}),n.d(e,"b",function(){return b}),n.d(e,"c",function(){return y});var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},h=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},g=function(t){function e(e,n,r,s){var a=t.call(this)||this;return a.mapService=r,a.winRef=s,a.campaignMode=!1,a.mapUsers=[],a.newUsersList=[],a.removeUsersList=[],a.curOwner=null,a.placeHolderTxt="Type and select name",a.ownerCardTitle="Map Owner",a.ownershipPersonalDuration="3 months",a.ownershipDuration="2 weeks",a.ownerCardDesc="An owner can use/share the map within "+a.ownershipDuration+" from the time of assignment. After this time, the map will be removed from the owner's assignment list. Please reassign ownership if needed. A map can only have one owner. Removing an owner, will remove all users.",a.defaultOwnerCardDesc=a.ownerCardDesc,a.ownershipPersonalDesc="Please consult the Service Overseer when assigning personal territories. An owner can use/share the map within "+a.ownershipPersonalDuration+" from the time of assignment. After this time, the map will be removed from the owner's assignment list. Please reassign ownership if needed. A map can only have one owner. Removing an owner, will remove all users.",a.shareCardTitle="Map Users",a.shareCardDesc="A user will have access to the map within the day of the assignment. After this time, the map will be removed from the user's list. Please reshare again if needed.",a.ownerMode=!1,a.dialog=e,a.fireAuth=n,a}return l(e,t),e.prototype.showShareDlg=function(t){var e=this;void 0===t&&(t=!0),this.ownerMode=t,this.subs.push(this.fireAuth.getAllUsersList().subscribe(function(t){e.mapUsers=t,e.isPersonal=e.map.assgnObj.isPersonal,e.notes=e.map.assgnObj.notes,e.ownerMode&&e.map.hasOwner()?(e.curOwner=e.map.getOwner(),e.userList=[e.curOwner]):e.userList=e.map.getUsersList(),e.shareDlg||(e.shareDlg=e.dialog.open(b,{data:{consumer:e},disableClose:!0}))}))},e.prototype.done=function(){this.showLoadingDialog(),this.ownerMode?p.isEmpty(this.userList)?(this.mapService.removeOwner(this.map,this.curOwner,this.notes),this.mapService.removeUsers(this.map,this.map.getUsersList())):(this.isPersonal?this.userList[0].expiry=u()().hour(18).minute(0).second(0).add(3,"months").toDate():this.userList[0].expiry=u()().hour(18).minute(0).second(0).add(16,"days").toDate(),this.mapService.updateOwner(this.map,this.userList[0],this.curOwner,this.isPersonal,this.notes)):p.isEmpty(this.userList)?(console.log("Remove userslist"),console.log(this.removeUsersList),this.mapService.removeUsers(this.map,this.removeUsersList)):(p.forEach(this.newUsersList,function(t){t.expiry=u()().hour(20).minute(0).second(0).add(1,"day").toDate()}),this.mapService.removeUsers(this.map,this.removeUsersList),this.mapService.updateUsers(this.map,this.userList)),this.closeShareDialog(),this.hideLoadingDialog()},e.prototype.cancel=function(){this.closeShareDialog()},e.prototype.closeShareDialog=function(){this.shareDlg.close(),this.shareDlg=null},e.prototype.canAssignOwner=function(){if("Queue"==this.map.mapObj.fsg)return!1;var t=this.map.mapObj.doneCtr;return this.campaignMode&&(t=this.map.mapObj.campaignCtr),!(t>0&&!this.fireAuth.currentUser.isAdmin()&&!this.map.hasOwner())&&(this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e.prototype.canShare=function(){return this.map.hasOwner()},e.prototype.canReturn=function(){return this.map.hasOwner()&&this.map.isOwner(this.fireAuth.currentUser)},e.prototype.confirmReturnDlg=function(){this.confirmDlg=this.dialog.open(y,{data:{consumer:this},disableClose:!0})},e.prototype.closeConfirmDlg=function(){this.confirmDlg.close(),this.confirmDlg=null},e.prototype.returnMap=function(){this.fireAuth.currentUser.isAdmin()?(this.mapService.removeUsers(this.map,this.map.getUsersList()),this.mapService.updateUsers(this.map,[]),this.mapService.removeOwner(this.map,this.map.getOwner())):this.map.isOwner(this.fireAuth.currentUser)&&(this.mapService.removeUsers(this.map,this.map.getUsersList()),this.mapService.updateUsers(this.map,[]),this.mapService.removeOwner(this.map,this.map.getOwner())),this.closeConfirmDlg()},e.prototype.onItemAdded=function(t){this.newUsersList.push(t),p.remove(this.removeUsersList,function(e){return e.id==t.id})},e.prototype.onItemRemove=function(t){console.log(t),p.remove(this.newUsersList,function(e){return e.id==t.id}),this.removeUsersList.push(t)},e.prototype.togglePersonal=function(){this.isPersonal?this.ownerCardDesc=this.ownershipPersonalDesc:this.ownerCardDesc=this.defaultOwnerCardDesc},e}(o.a);m([n.i(r.Input)(),h("design:type","function"==typeof(v=void 0!==s.b&&s.b)&&v||Object)],g.prototype,"map",void 0),m([n.i(r.Input)(),h("design:type",Boolean)],g.prototype,"campaignMode",void 0),g=m([n.i(r.Component)({selector:"mapshare",template:n("RvYO")}),h("design:paramtypes",["function"==typeof(M=void 0!==a.b&&a.b)&&M||Object,"function"==typeof(O=void 0!==i.a&&i.a)&&O||Object,"function"==typeof(A=void 0!==s.a&&s.a)&&A||Object,"function"==typeof(j=void 0!==d.a&&d.a)&&j||Object])],g);var b=function(){function t(t,e){this.dialogRef=t,this.data=e}return t.prototype.displayFn=function(t){return t?t.userInfoObj.name:""},t}();b=m([n.i(r.Component)({selector:"share-dlg",template:n("APxZ")}),f(1,n.i(r.Inject)(a.c)),h("design:paramtypes",["function"==typeof(w=void 0!==a.d&&a.d)&&w||Object,Object])],b);var y=function(){function t(t,e){this.dialogRef=t,this.data=e}return t}();y=m([n.i(r.Component)({selector:"share-dlg",template:n("rN+S")}),f(1,n.i(r.Inject)(a.c)),h("design:paramtypes",["function"==typeof(_=void 0!==a.d&&a.d)&&_||Object,Object])],y);var v,M,O,A,j,w,_},Dcui:function(t,e,n){"use strict";var r=n("/oeL");n.d(e,"a",function(){return a});var s=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},a=function(){function t(){}return Object.defineProperty(t.prototype,"nativeWindow",{get:function(){return window},enumerable:!0,configurable:!0}),t.prototype.redirHttps=function(){var t=this.nativeWindow;if("localhost"!=t.location.hostname&&-1==t.location.hostname.indexOf("10.0.0")&&"https:"!=t.location.protocol){var e="https://"+t.location.hostname+(t.location.port?":"+t.location.port:"")+t.location.pathname+t.location.hash;console.log(e),t.location=e}else console.log("No https redir")},t.prototype.location=function(t){this.nativeWindow.location=t},t}();a=s([n.i(r.Injectable)()],a)},Ep1E:function(t,e){t.exports='<div mat-dialog-content>\r\n  <mat-card>\r\n    <mat-card-title *ngIf="data.title">\r\n      <h4>{{data.title}}</h4>\r\n    </mat-card-title>\r\n    <mat-card-subtitle *ngIf="data.subtitle"><div>{{ data.subtitle }}</div></mat-card-subtitle>\r\n    <mat-card-actions>\r\n      <div>\r\n        <br/>\r\n        <button mat-raised-button color="accent" (click)="data.consumer.confirmNotification()">{{ data.confirmText }}</button>\r\n      </div>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n'},GsmQ:function(t,e,n){"use strict";var r=n("/oeL"),s=n("Dqrr"),a=(n.n(s),n("xrDH")),o=(n.n(a),n("HAwn")),i=n("PMtK"),d=n.n(i);n.d(e,"b",function(){return p}),n.d(e,"a",function(){return h});var c=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(){function t(t,e,n){this.id=t,this.mapObj=e,this.assgnObj=n,a.isUndefined(e)||a.isEmpty(e.addresses)?this.addressCount=0:this.addressCount=a.size(e.addresses)}return Object.defineProperty(t.prototype,"isAssigned",{get:function(){return this.assgnObj.$exists()},enumerable:!0,configurable:!0}),t.prototype.hasOwner=function(){return this.assgnObj&&this.assgnObj.$exists()&&!a.isEmpty(this.assgnObj.owner)},Object.defineProperty(t.prototype,"ownerInfo",{get:function(){return this.assgnObj.owner},enumerable:!0,configurable:!0}),t.prototype.getOwner=function(){return this.assgnObj.owner},t.prototype.setOwner=function(t){!a.isFunction(this.assgnObj.$exists)&&this.assgnObj.$exists()||(this.assgnObj={}),this.assgnObj.owner||(this.assgnObj.owner={}),this.assgnObj.owner.id=t.$key,this.assgnObj.owner.name=t.name},t.prototype.getUsersList=function(){var t=[];return a.forOwn(this.assgnObj.users,function(e,n){t.push({name:e.name,id:n,expiry:e.expiry})}),t},t.prototype.hasUsers=function(){return!a.isEmpty(this.getUsersList())},t.prototype.isOwner=function(t){return t.userInfoObj.$key==this.assgnObj.owner.id},t.prototype.isUser=function(t){var e=null!=a.find(this.getUsersList(),function(e){return e.id==t.userInfoObj.$key});return this.hasOwner()&&this.isOwner(t)||this.hasUsers()&&e},t.prototype.getStatus=function(t){return a.get(this.assgnObj,"address."+t)},t.prototype.setStatus=function(t,e){a.isUndefined(this.assgnObj.address)&&(this.assgnObj.address={}),this.assgnObj.address[t]=e},t.prototype.getStatusDetail=function(t){return a.get(this.assgnObj,"det."+t)},t.prototype.setStatusDetail=function(t,e){a.isUndefined(this.assgnObj.det)&&(this.assgnObj.det={}),this.assgnObj.det[t]=e},t.prototype.getAddrStatuses=function(t,e){var n=this,r=[];return t.isAdmin()||t.isUpdater()?r=this.mapObj.search?a.filter(e.addrStatuses,function(t){return 10!=t.val&&4!=t.val&&(3==t.val&&(t.label="Not at Home"),t)}):a.filter(e.addrStatuses,function(t){return e.isNormalMode()?10!=t.val&&t:e.isCampaignVisitOnce()?3!=t.val&&4!=t.val&&10!=t.val&&t:10!=t.val&&t}):e.isNormalMode()?a.forEach(e.addrStatuses,function(t){if(5!=t.val&&7!=t.val){if(n.mapObj.search&&(10==t.val||4==t.val))return!0;if(3==t.val&&n.mapObj.search)t.label="Not at Home";else if(10==t.val)return!0;r.push(t)}}):a.forEach(e.addrStatuses,function(t){if(5!=t.val&&7!=t.val&&10!=t.val){if(e.isCampaignVisitOnce()&&(3==t.val||4==t.val))return!0;r.push(t)}}),r},t}(),l=function(){function t(t,e,n){void 0===n&&(n=null),this.fsgName=t,this.maps=e,this.completedMapsCtr=0,this.completionRate=0,this.metadata=n}return t.prototype.getCompletionPercent=function(){return this.completionRate},t.prototype.computeCompleted=function(){var t=this;a.each(this.maps,function(e){t.metadata.mode.campaign?e.mapObj.campaignCtr>0&&t.completedMapsCtr++:e.mapObj.doneCtr>0&&t.completedMapsCtr++}),this.completionRate=0==this.completedMapsCtr?0:Math.floor(this.completedMapsCtr/this.maps.length*100)},t}(),m=function(){function t(){}return t}(),h=function(){function t(t){var e=this;this.db=t,this.onUpdate=new r.EventEmitter,this.mapMarkers=[],this.markerIdx=0,this.trackUpdates=!1,this.updatePipe=new s.Subject,this.subs=[],this.fsgs=[],this.addrStatuses=[{val:0,label:"Not Done"},{val:1,label:"Done - Mandarin"},{val:9,label:"Done - Cantonese"},{val:2,label:"Not Chinese"},{val:3,label:"Not at Home - 1"},{val:4,label:"Not at Home - 2"},{val:10,label:"Not at Home - 3"},{val:5,label:"Do Not Call"},{val:7,label:"Phone Witnessing"},{val:8,label:"Reported Issue"}],this.currentActiveMapRoot="/assignedMaps/active/",this.errorMap={NO_ADDRESS:new Error("No Addresses")},this.maps=[],this.updatePipe.debounceTime(5e3).subscribe(function(t){e.onUpdate.emit(t)})}return t.prototype.getMetadata=function(){var t=this;return this.metadata?s.Observable.of(this.metadata):this.db.object("/metadata").flatMap(function(e){return t.metadata=e,t.metadata.mode.campaign&&(t.currentActiveMapRoot="/assignedMaps/campaign/"),s.Observable.of(t.metadata)})},t.prototype.triggerUpdate=function(){this.onUpdate.emit({})},t.prototype.loadMapMarkersObs=function(t,e){var n=this,r={},o=null;return this.db.object("/maps/"+e).flatMap(function(t){return console.log(t),n.maps.push(t),r.mapObj=t,t.addresses?n.trackUpdates?(n.updatePipe.next({}),s.Observable.of(null)):s.Observable.of(t):(console.log("Ooops, no addresses for this map: "+e),s.Observable.throw(n.errorMap.NO_ADDRESS))}).filter(function(t){return null!=t}).flatMap(function(t){return n.db.object(""+n.currentActiveMapRoot+e).flatMap(function(e){return console.log("Got assigned maps object..."),r.assgnObj=e,s.Observable.of(t)})}).flatMap(function(t){return n.db.list("/maps/"+e+"/addresses").flatMap(function(t){return o=t,s.Observable.from(t)})}).filter(function(t){return null!=t}).flatMap(function(t){return n.db.object("/addresses/"+t.$value)}).filter(function(t){return null!=t}).flatMap(function(t){r.addresses||(r.addresses=[]),a.remove(r.addresses,function(e){return e.$key==t.$key}),t.addId=t.$key;var e=null;return a.each(o,function(n){if(n.$value==t.addId)return e=n.$key,!1}),e&&(t.mapAddrKey=e),r.addresses.push(t),s.Observable.of(t)}).flatMap(function(t){return s.Observable.of(r)}).debounce(function(){return s.Observable.interval(1e3)}).flatMap(function(t){var n=new p(e,r.mapObj,r.assgnObj);return a.forEach(r.addresses,function(t){a.forOwn(r.assgnObj.address,function(e,n){n==t.$key&&(t.status=a.toNumber(e))}),(a.isUndefined(t.status)||a.isNull(t.status))&&(t.status=0)}),n.addresses=r.addresses,s.Observable.of(n)})},t.prototype.deleteAddress=function(t,e,n,r){var s={};s["/maps/"+n+"/addresses/"+e]=null,s["/addresses/"+t]=null,s[""+this.currentActiveMapRoot+n+"/address/"+e]=null,console.log(s),this.db.database.ref().update(s).then(function(){r()})},t.prototype.deleteMap=function(t,e,n,r,s){var o={};o["/maps/"+t]=null,o["/fsg/"+n+"/"+e]=null,a.each(r,function(t){o["/addresses/"+t.$key+"/map"]="Deleted",o["/addresses/"+t.$key+"/mapId"]="0000",o["/addresses/"+t.$key+"/map"]="Deleted",o["/addresses/"+t.$key+"/fsg"]="Deleted"}),console.log(o),this.db.database.ref().update(o).then(function(){s()})},t.prototype.createStatusMarkerIconConfig=function(t,e){return{scaledSize:t,url:"/assets/images/place-markers/status-"+e+".svg"}},t.prototype.createMarkersWithStatus=function(t){var e=this,n=new google.maps.Size(35,35),r={},s=this.createStatusMarkerIconConfig(n,403);a.forEach(this.addrStatuses,function(t){a.isEmpty(t)&&(t=0),r[t.val]=e.createStatusMarkerIconConfig(n,t.val)}),a.forEach(t.addresses,function(n){var o=null,i=n.$key;if(e.trackUpdates){if(!(o=a.find(e.mapMarkers,function(t){return a.find(t.addId,function(t){return t==i})})))return!0}else o=new m,o.addId=[i],o.map=t;n.clat=a.toNumber(n.clat),n.clong=a.toNumber(n.clong);var d=a.find(e.mapMarkers,function(t){return a.isArray(t.addObj)?a.find(t.addObj,function(t){return t.clat==n.clat&&t.clong==n.clong&&t.$key!=i}):t.addObj.clat==n.clat&&t.addObj.clong==n.clong&&t.addObj.$key!=i});if(d){if(!e.trackUpdates){if(a.isArray(d.addObj))d.addObj.push(n);else{var c=[d.addObj];c.push(n),d.addObj=c}o=d,o.addId.push(i)}}else o.addObj=n;o.mapObj=t.mapObj,o.modalMode=!0;var u=s;if(d){if(n.status){u=r[n.status];var p=a.map(d.addObj,function(t){return t.status});a.forEach(p,function(t){switch(t){case 0:case 3:u=r[t]}})}else a.isEmpty(t.assgnObj.started)||(u=r[0]);d.marker=new google.maps.Marker({position:new google.maps.LatLng(n.clat,n.clong),icon:u,label:""+d.addObj.length})}else n.status?u=r[n.status]:a.isEmpty(t.assgnObj.started)||(u=r[0]),o.marker=new google.maps.Marker({position:new google.maps.LatLng(n.clat,n.clong),icon:u}),e.trackUpdates||e.mapMarkers.push(o)})},t.prototype.loadMapMarkers=function(t,e,n){var r=this;void 0===n&&(n=!1),this.subs.push(this.db.object("/maps/"+e).subscribe(function(t){if(t.addresses){r.trackUpdates?r.updatePipe.next({}):r.maps.push(t);var s=r.markerIdx++,o=0;a.forEach(t.addresses,function(i){console.log("/addresses/"+i),r.subs.push(r.db.object("/addresses/"+i).subscribe(function(d){if(a.isEmpty(d.burb))console.log("Address not found: "+i+" in map: "+e);else{o++;var c=null;r.trackUpdates?c=a.find(r.mapMarkers,function(t){return t.addId==i}):(c=new m,c.addId=i),d.clat=a.toNumber(d.clat),d.clong=a.toNumber(d.clong),c.addObj=d,c.mapObj=t,n?c.modalMode=n:(c.url="/map/"+e,c.infoWindowStr="\n                                          <div>Address: "+(-9==d.unit||a.isEmpty(d.unit)?"":"Unit "+d.unit)+" "+d.hnum+" "+d.st+", "+d.burb+"</div>\n                                          <div>Map: <a href='"+c.url+"' target='_blank'>"+t.terId+" - "+t.name+"</a></div>\n                                          <div>FSG: "+t.fsg+"</div>\n                                        ",c.markerIdx=s),r.trackUpdates||r.mapMarkers.push(c)}}))})}else console.log("Map not found: "+e)}))},t.prototype.loadAllMapsWithMarkers=function(t){var e=this;this.subs.push(this.db.list("/fsg/list").subscribe(function(n){n.forEach(function(n){"Queue"!=n.$value&&e.subs.push(e.db.list("/fsg/"+n.$value).subscribe(function(n){n.forEach(function(n){e.loadMapMarkers(t,n.$value)})}))})}))},t.prototype.clearAllMarkers=function(){a.forEach(this.subs,function(t){t.unsubscribe()}),this.subs.length=0,this.maps.length=0,this.mapMarkers.length=0,this.trackUpdates=!1,this.triggerUpdate()},t.prototype.getAllFsgMaps=function(t){var e=this;return this.fsgs.length=0,this.db.object("/fsg/list").flatMap(function(t){var e=[];return a.forOwn(t,function(t,n){e.push({$key:n,$value:t})}),s.Observable.from(e)}).flatMap(function(n){var r=n.$value;return e.db.object("/fsg/"+r).flatMap(function(e){var n=[];return a.forOwn(e,function(t,e){n.push({$key:e,$value:t})}),n.forEach(function(e){t[e.$value]={fsgName:r,mapKey:e.$key}}),s.Observable.from(n)})})},t.prototype.getAllFsgMapsList=function(t){var e=this;void 0===t&&(t=!1);var n={};return this.getAllFsgMaps(n).flatMap(function(t){return e.db.object("/maps/"+t.$value)}).flatMap(function(t){return n[t.$key].mapObj=t,e.db.object(""+e.currentActiveMapRoot+t.$key).flatMap(function(e){return n[t.$key].assgnObj=e,s.Observable.of(t)})}).flatMap(function(t){return s.Observable.of(n)}).debounce(function(){return s.Observable.interval(1e3)}).flatMap(function(r){return a.forOwn(n,function(t,n){var r=a.find(e.fsgs,function(e){return e.fsgName==t.fsgName});r||(r=new l(t.fsgName,[],e.metadata),e.fsgs.push(r));var s=a.find(r.maps,function(t){return t.id==n});s?(s.mapObj=t.mapObj,s.assgnObj=t.assgnObj):r.maps.push(new p(n,t.mapObj,t.assgnObj))}),t&&a.each(e.fsgs,function(t){var e=a.sortBy(t.maps,[function(t){return t.assgnObj&&t.assgnObj.started?d()(t.assgnObj.started).unix():null},function(t){return t.mapObj&&t.mapObj.lastCompleted?d()(t.mapObj.lastCompleted).unix():0}]);t.maps=e}),s.Observable.of(e.fsgs)})},t.prototype.getUserMaps=function(t){var e=this,n={};return this.db.object(this.getUserMapPath(t.userInfoObj.$key)).flatMap(function(t){if(console.log("Got user maps list..."),e.fsgs=[],t.$exists()){var n=[];return a.forOwn(t,function(t,e){n.push(e)}),s.Observable.from(n)}return s.Observable.of(null)}).flatMap(function(t){return console.log("Got map id...."),e.fsgs.length=0,t?e.db.object("/maps/"+t):s.Observable.of(null)}).flatMap(function(t){return console.log("Got map obj...."),e.fsgs.length=0,t?(a.isEmpty(n[t.$key])&&(n[t.$key]={fsgName:"Your Maps"}),n[t.$key].mapObj=t,e.db.object(""+e.currentActiveMapRoot+t.$key).flatMap(function(e){return n[t.$key].assgnObj=e,s.Observable.of(t)})):s.Observable.of(null)}).flatMap(function(t){return s.Observable.of(n)}).debounce(function(){return s.Observable.interval(1e3)}).flatMap(function(t){var e=[];return a.forOwn(n,function(t,n){var r=a.find(e,function(e){return e.fsgName==t.fsgName});r||(r=new l(t.fsgName,[]),e.push(r)),r.maps.push(new p(n,t.mapObj,t.assgnObj))}),s.Observable.of(e)})},t.prototype.updateLastSaved=function(t,e){},t.prototype.updateOwner=function(t,e,n,r,s){void 0===r&&(r=!1),void 0===s&&(s=null);var o={};t.assgnObj.address&&(o[""+this.currentActiveMapRoot+t.id+"/address"]=t.assgnObj.address),t.assgnObj.users&&(o[""+this.currentActiveMapRoot+t.id+"/users"]=t.assgnObj.users),a.isEmpty(t.assgnObj.started)&&(o[""+this.currentActiveMapRoot+t.id+"/started"]=d()().toDate()),n&&e.id!=n.id&&(o[""+this.currentActiveMapRoot+t.id+"/prevOwner"]=n),a.isNull(s)||(o[""+this.currentActiveMapRoot+t.id+"/notes"]=s),o[""+this.currentActiveMapRoot+t.id+"/owner"]={id:e.id,name:e.name,expiry:e.expiry},o[""+this.currentActiveMapRoot+t.id+"/expiry"]=e.expiry,o[""+this.currentActiveMapRoot+t.id+"/isPersonal"]=r,o[this.getUserMapPath(e.id,t.id)+"/expiry"]=e.expiry,this.db.database.ref().update(o)},t.prototype.updateUsers=function(t,e){var n=this,r={},s={};a.forEach(e,function(e){s[e.id]={name:e.name,expiry:e.expiry},r[n.getUserMapPath(e.id,t.id)+"/expiry"]=e.expiry}),r[""+this.currentActiveMapRoot+t.id+"/users"]=s,console.log(r),this.db.database.ref().update(r)},t.prototype.removeOwner=function(t,e,n){void 0===n&&(n=null);var r={};a.isNull(n)||(r[""+this.currentActiveMapRoot+t.id+"/notes"]=n),r[""+this.currentActiveMapRoot+t.id+"/owner"]=null,r[""+this.currentActiveMapRoot+t.id+"/expiry"]=null,r[""+this.getUserMapPath(e.id,t.id)]=null,r[""+this.currentActiveMapRoot+t.id+"/prevOwner"]=e,this.db.database.ref().update(r)},t.prototype.removeUsers=function(t,e){var n=this,r={};a.forEach(e,function(e){r[""+n.getUserMapPath(e.id,t.id)]=null,r[""+n.currentActiveMapRoot+t.id+"/users/"+e.id]=null}),this.db.database.ref().update(r)},t.prototype.saveAddr=function(t,e,n,r){var s=this;void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null);var o={};a.each(t,function(t){var r=null;if(a.isString(t)||a.isNumber(t)){if(e&&n){var i=e.id,d=n.id,c="/addresses/"+r;o[c+"/terId"]=e.mapObj.terId,o[c+"/mapId"]=d,o[c+"/map"]=n.mapObj.name,o["/maps/"+d+"/addresses/"+r]=r,o["/maps/"+i+"/addresses/"+r]=null}}else{r=t.addId,a.isUndefined(r)&&(r=s.metadata.ids.addId,s.metadata.ids.addId++,o["/metadata/ids/addId"]=s.metadata.ids.addId);var c="/addresses/"+r;if(o[c+"/unit"]=s.getValueEmptyIfUndefined(t.unit),o[c+"/hnum"]=s.getValueEmptyIfUndefined(t.hnum),o[c+"/st"]=s.getValueEmptyIfUndefined(t.st),o[c+"/lSt"]=s.getValueEmptyIfUndefined(a.toLower(t.st)),o[c+"/burb"]=s.getValueEmptyIfUndefined(t.burb),o[c+"/pcode"]=s.getValueEmptyIfUndefined(t.pcode),o[c+"/tel"]=s.getValueEmptyIfUndefined(t.tel),o[c+"/clat"]=s.getValueEmptyIfUndefined(t.clat),o[c+"/clong"]=s.getValueEmptyIfUndefined(t.clong),e){var u=e.id;o[c+"/terId"]=e.mapObj.terId,o[c+"/mapId"]=u,o[c+"/map"]=e.mapObj.name,o["/maps/"+u+"/addresses/"+r]=r}}}),console.log(o),this.db.database.ref().update(o).then(function(){r&&r()})},t.prototype.getValueEmptyIfUndefined=function(t){return a.isUndefined(t)?"":t},t.prototype.updateAddrStat=function(t,e,n,r,s){void 0===s&&(s=null);var a={},o={};a[""+this.currentActiveMapRoot+t+"/address/"+e]=n,3!=n&&4!=n||(o.nh_when=d()().toDate(),o.nh_by=r.userInfoObj.name,a[""+this.currentActiveMapRoot+t+"/det/"+e+"/nh_when"]=o.nh_when,a[""+this.currentActiveMapRoot+t+"/det/"+e+"/nh_by"]=o.nh_by),a[""+this.currentActiveMapRoot+t+"/lastSaved"]={id:r.userObj.uid,name:r.userInfoObj.name,when:d()().toDate()},this.db.database.ref().update(a).then(function(){s&&s(e,n,o)})},t.prototype.updateAddrStats=function(t,e,n){var r=this;void 0===n&&(n=null);var s={},o=t.mapObj;a.each(t.addresses,function(t){var n={},a=o.$key,i=t.addId,c=t.status;s[""+r.currentActiveMapRoot+a+"/address/"+i]=c,3!=c&&4!=c||(n.nh_when=d()().toDate(),n.nh_by=e.userInfoObj.name,s[""+r.currentActiveMapRoot+a+"/det/"+i+"/nh_when"]=n.nh_when,s[""+r.currentActiveMapRoot+a+"/det/"+i+"/nh_by"]=n.nh_by),s[""+r.currentActiveMapRoot+a+"/lastSaved"]={id:e.userObj.uid,name:e.userInfoObj.name,when:d()().toDate()}}),this.db.database.ref().update(s).then(function(){n&&n(o)})},t.prototype.getCompletionPercentage=function(t){return t.mapObj.addresses&&t.assgnObj&&!a.isUndefined(t.assgnObj.address)?Math.round(this.getVisitedAddresses(t)/t.addressCount*100):0},t.prototype.getVisitedAddresses=function(t){var e=0;return t.mapObj.addresses&&t.assgnObj&&!a.isUndefined(t.assgnObj.address)?(a.forOwn(t.mapObj.addresses,function(n,r){if(!a.isUndefined(t.assgnObj.address[n])){switch(a.toNumber(t.assgnObj.address[n])){case 1:case 2:case 5:case 7:case 8:case 9:case 10:e++;break;case 4:t.mapObj.search||e++}}}),e):0},t.prototype.getRemainingAddresses=function(t){return t.addressCount-this.getVisitedAddresses(t)},t.prototype.getUserMapPath=function(t,e){return void 0===e&&(e=null),this.metadata.mode.campaign?"/users/"+t+"/campaign"+(a.isNull(e)?"":"/"+e):"/users/"+t+"/maps"+(a.isNull(e)?"":"/"+e)},t.prototype.getMapsUserUri=function(){return this.metadata.mode.campaign?"campaignUsers":"users"},t.prototype.isNormalMode=function(){return!this.metadata.mode.campaign},t.prototype.isCampaignVisitOnce=function(){return this.metadata.mode.campaignVisitOnce},t.prototype.enableGeolocation=function(t){navigator.geolocation&&(this.locationWatch=navigator.geolocation.watchPosition(function(e){t.emit({position:{lat:e.coords.latitude,lng:e.coords.longitude}})},function(t){console.error(t)}))},t.prototype.disableGeolocation=function(t){navigator.geolocation&&(navigator.geolocation.clearWatch(this.locationWatch),t.emit(null))},t.prototype.findByStreet=function(t,e){this.findByTerm("/addresses/","lSt",a.toLower(t),!1,e)},t.prototype.findByTerm=function(t,e,n,r,s){var o=this.db.database.ref();r?o.child(t).orderByChild(e).equalTo(n).on("value",function(r){r.val()?s(r.val()):o.child(t).orderByChild(e).equalTo(a.toInteger(n)).on("value",function(t){s(t.val())})}):o.child(t).orderByChild(e).startAt(n).endAt(n+"").on("value",function(t){s(t.val())})},t.prototype.fsgHasCompletion=function(t){return"Search"!=t&&"Queue"!=t},t.prototype.addNewFsg=function(t,e){var n={};n["/fsg/list/"+t]=t,n["/fsg/"+t]=0,this.db.database.ref().update(n).then(function(){e&&e()})},t.prototype.addNewMap=function(t,e,n,r){var s={},o=this.metadata.ids.terId;s["/maps/"+o]={name:e,lname:a.toLower(e),fsg:t,terId:o},s["/fsg/"+t+"/"+o]=o,s["/metadata/ids/terId"]=o+1,this.db.database.ref().update(s).then(function(){r&&r()})},t.prototype.findByTerId=function(t,e){this.findByTerm("/maps/","terId",t,!0,e)},t.prototype.moveAddress=function(t,e,n,r,s,o,i){var d={};a.each(o,function(a){d["/maps/"+t+"/addresses/"+a.mapAddrKey]=null,d["/maps/"+e+"/addresses/"+a.addId]=a.addId,d["/addresses/"+a.addId+"/mapId"]=n,d["/addresses/"+a.addId+"/map"]=r,d["/addresses/"+a.addId+"/fsg"]=s}),console.log(d),this.db.database.ref().update(d).then(function(){i&&i()})},t.prototype.moveMap=function(t,e,n,r,s,o){var i={};i["/maps/"+t+"/fsg"]=s,i["/maps/"+t+"/name"]=n,i["/maps/"+t+"/lName"]=a.toLower(n),i["/fsg/"+r+"/"+e]=null,i["/fsg/"+s+"/"+t]=t,console.log(i),this.db.database.ref().update(i).then(function(){o&&o()})},t}();c([n.i(r.Output)(),u("design:type",Object)],h.prototype,"onUpdate",void 0),h=c([n.i(r.Injectable)(),u("design:paramtypes",["function"==typeof(f=void 0!==o.a&&o.a)&&f||Object])],h);var f},HGbW:function(t,e,n){"use strict";var r=n("hoZb"),s=n("xrDH"),a=(n.n(s),n("+tBu"));n.d(e,"a",function(){return o});var o=function(){function t(){this.subs=[]}return t.prototype.showLoadingDialog=function(){this.loadingDialog=this.dialog.open(r.a,{disableClose:!0})},t.prototype.hideLoadingDialog=function(){this.loadingDialog&&(this.loadingDialog.close(),this.loadingDialog=null)},t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){this.unsubscribeAll()},t.prototype.unsubscribeAll=function(){s.forEach(this.subs,function(t){t.unsubscribe()})},t.prototype.requireLogin=function(){var t=this;this.subs.push(this.fireAuth.getUserObs().subscribe(function(e){e?(t.loginDiag&&t.loginDiag.close(),t.fireAuth.currentUser?t.postLoginSetup():(t.fireAuth.getAllUserInfo(),t.subs.push(t.fireAuth.onCurrentUserInfo.subscribe(function(e){t.postLoginSetup()})))):t.loginDiag=t.dialog.open(a.a,{data:{consumer:t},disableClose:!0})}))},t.prototype.postLoginSetup=function(){console.log("BaseComponent post login, doing nothing.")},t.prototype.login=function(t){var e=this;this.errorMsg="",console.log("BaseComponent logging in: "),console.log(t),this.showLoadingDialog(),this.fireAuth.login(t.email,t.password).then(function(t){e.hideLoadingDialog()}).catch(function(t){e.hideLoadingDialog(),console.log(t);var n=t.message;e.errorMsg=n})},t.prototype.logout=function(){this.fireAuth.logout()},t}()},HbVw:function(t,e,n){"use strict";var r=n("fc+i"),s=n("/oeL"),a=n("bm2B"),o=n("13je"),i=n("HAwn"),d=n("2LMR"),c=n("p5Ee"),u=n("0+Pn"),p=n("mPw8"),l=n("6lRS"),m=n("76ka"),h=n("cn2Z");n.n(h);n.d(e,"a",function(){return g});var f=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},g=function(){function t(){}return t}();g=f([n.i(s.NgModule)({imports:[r.a,a.FormsModule,o.b.initializeApp(c.a.firebase),i.b,d.b,h.TagInputModule,l.u,l.h,l.f,l.n,l.i],exports:[p.a,m.a,m.b,m.c,m.d],declarations:[p.a,m.a,m.b,m.c,m.d],bootstrap:[],providers:[u.a],entryComponents:[m.b,m.c,m.d]})],g)},Iqat:function(t,e,n){"use strict";var r=n("/oeL"),s=n("BkNc"),a=n("SAdc"),o=n("wINU"),i=n("eb9A");n.d(e,"a",function(){return u});var d=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},c=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:a.a},{path:"map/:id",component:o.a},{path:"mapadmin",component:i.a}],u=function(){function t(){}return t}();u=d([n.i(r.NgModule)({imports:[s.a.forRoot(c)],exports:[s.a]})],u);a.a,o.a,i.a},KJMk:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},MnZv:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},RvYO:function(t,e){t.exports='<button mat-mini-fab (click)="showShareDlg(true)" *ngIf="canAssignOwner()"><mat-icon>assignment_ind</mat-icon></button>\r\n<button mat-mini-fab (click)="showShareDlg(false)" *ngIf="canShare()"><mat-icon>share</mat-icon></button>\r\n<button mat-mini-fab (click)="confirmReturnDlg()" *ngIf="canReturn()"><mat-icon>assignment_return</mat-icon></button>\r\n'},SAdc:function(t,e,n){"use strict";var r=n("/oeL"),s=n("0+Pn"),a=n("6lRS"),o=n("0o1w"),i=n("HGbW"),d=n("fc+i"),c=n("p5Ee");n.d(e,"a",function(){return h}),n.d(e,"b",function(){return f});var u=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},m=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},h=function(t){function e(e,n,r,s){var a=t.call(this)||this;return a.appTitle=c.a.app.title+" "+c.a.version.current,a.dialog=n,a.fireAuth=e,a.errorMsg=a.fireAuth.currentUser?"":"Please login.",a.requireLogin(),r.addSvgIcon("add-address",s.bypassSecurityTrustResourceUrl("/assets/images/add_address.svg")),a}return u(e,t),e.prototype.postLoginSetup=function(){console.log("Home Component Post Login");var t=this.fireAuth.currentUser&&this.fireAuth.currentUser.userInfoObj?this.fireAuth.currentUser.userInfoObj.name:"";this.addUrl="https://docs.google.com/forms/d/e/1FAIpQLSdZYe2BmeJ_DLwW1lbvu9bcLWe7_wZ3Rs5fdaw-q4g9zfys3g/viewform?usp=pp_url&entry.1810388592=Yes&entry.1189370340=&entry.45257833&entry.681741514=&entry.1482719893=&entry.1683213160=%E6%98%AF&entry.293956968=&entry.602343366&entry.2071713990=&entry.138422963=&entry.1018422546&entry.2060338072&entry.1052547294&entry.365006055&entry.1323592748=&entry.1534052334="+t+"&entry.1011916189&entry.1303192619&entry.825337910&entry.1931492709&entry.2023645450=&entry.913416032="+t,this.mapListComp.load()},e.prototype.canViewAllMaps=function(){return this.fireAuth.currentUser&&(this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e}(i.a);p([n.i(r.ViewChild)("myMapsList"),l("design:type","function"==typeof(g=void 0!==o.a&&o.a)&&g||Object)],h.prototype,"mapListComp",void 0),h=p([n.i(r.Component)({selector:"home-component",template:n("zgAq"),styles:[n("MnZv")]}),l("design:paramtypes",["function"==typeof(b=void 0!==s.a&&s.a)&&b||Object,"function"==typeof(y=void 0!==a.b&&a.b)&&y||Object,"function"==typeof(v=void 0!==a.e&&a.e)&&v||Object,"function"==typeof(M=void 0!==d.d&&d.d)&&M||Object])],h);var f=function(){function t(t,e){this.dialogRef=t,this.data=e}return t}();f=p([n.i(r.Component)({selector:"notify-dlg",template:n("Ep1E")}),m(1,n.i(r.Inject)(a.c)),l("design:paramtypes",["function"==typeof(O=void 0!==a.d&&a.d)&&O||Object,Object])],f);var g,b,y,v,M,O},SicF:function(t,e){t.exports='<span *ngIf="user && user.userObj"><h3>{{user?.userInfoObj?.name}}</h3></span>\r\n'},Sx8v:function(t,e){t.exports='<div mat-dialog-content>\r\n  <form name=\'createUserForm\'>\r\n    <mat-card>\r\n      <mat-card-header>\r\n        <mat-card-title>\r\n          <h4>{{data.consumer.userSelectTitle}}</h4>\r\n        </mat-card-title>\r\n        <mat-card-subtitle>{{ data.consumer.userSelectDesc }}</mat-card-subtitle>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <mat-form-field>\r\n          <label>Name</label>\r\n          <input matInput type=\'text\' name="text" [(ngModel)]="data.consumer.newUser.name" >\r\n        </mat-form-field>\r\n        <mat-form-field>\r\n          <label>Email</label>\r\n          <input matInput type=\'email\' name="email" [(ngModel)]="data.consumer.newUser.email" >\r\n        </mat-form-field>\r\n      </mat-card-content>\r\n    </mat-card>\r\n  </form>\r\n  <mat-dialog-actions>\r\n    <button mat-mini-fab (click)="data.consumer.createUser()"><mat-icon>save</mat-icon></button>\r\n    <button mat-mini-fab (click)="data.consumer.cancel()"><mat-icon>cancel</mat-icon></button>\r\n  </mat-dialog-actions>\r\n  <div>\r\n    {{data.consumer.errorMsg}}\r\n  </div>\r\n</div>\r\n'},X0pD:function(t,e){t.exports='<mat-dialog-content>\r\n    <mat-card>\r\n      <mat-card-header>\r\n        <mat-card-title>\r\n          <h3>Version Release Notes</h3>\r\n        </mat-card-title>\r\n      </mat-card-header>\r\n      <mat-card-content style="height:400px; overflow-y: auto">\r\n        <mat-list>\r\n          <mat-list-item *ngFor="let version of data.consumer.getVersions()">\r\n            <h4 matLine> {{ version.versionNum }}</h4>\r\n            <p matLine> {{ version.text }} </p>\r\n          </mat-list-item>\r\n        </mat-list>\r\n      </mat-card-content>\r\n    </mat-card>\r\n</mat-dialog-content>\r\n<mat-dialog-actions>\r\n  <button mat-mini-fab (click)="data.consumer.cancel()"><mat-icon>cancel</mat-icon></button>\r\n  <div>\r\n    {{data.consumer.errorMsg}}\r\n  </div>\r\n</mat-dialog-actions>\r\n'},"Xir+":function(t,e){/**
 * @license
 * Copyright 2010 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function n(t,e,r){this.extend(n,google.maps.OverlayView),this.map_=t,this.showInfo=!1,this.markers_=[],this.clusters_=[],this.sizes=[53,56,66,78,90],this.styles_=[],this.ready_=!1;var s=r||{};this.gridSize_=s.gridSize||60,this.minClusterSize_=s.minimumClusterSize||2,this.maxZoom_=s.maxZoom||null,this.styles_=s.styles||[],this.imagePath_=s.imagePath||this.MARKER_CLUSTER_IMAGE_PATH_,this.imageExtension_=s.imageExtension||this.MARKER_CLUSTER_IMAGE_EXTENSION_,this.zoomOnClick_=!0,void 0!=s.zoomOnClick&&(this.zoomOnClick_=s.zoomOnClick),this.averageCenter_=!1,void 0!=s.averageCenter&&(this.averageCenter_=s.averageCenter),this.setupStyles_(),this.setMap(t),this.prevZoom_=this.map_.getZoom();var a=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var t=a.map_.getZoom();a.prevZoom_!=t&&(a.prevZoom_=t,a.resetViewport())}),google.maps.event.addListener(this.map_,"idle",function(){a.redraw()}),e&&e.length&&this.addMarkers(e,!1)}function r(t){this.markerClusterer_=t,this.map_=t.getMap(),this.gridSize_=t.getGridSize(),this.minClusterSize_=t.getMinClusterSize(),this.averageCenter_=t.isAverageCenter(),this.center_=null,this.markers_=[],this.bounds_=null,this.clusterIcon_=new s(this,t.getStyles(),t.getGridSize()),this.infoWindowStr=null}function s(t,e,n,r){t.getMarkerClusterer().extend(s,google.maps.OverlayView),this.styles_=e,this.padding_=n||0,this.cluster_=t,this.center_=null,this.map_=t.getMap(),this.div_=null,this.sums_=null,this.visible_=!1,this.infowindow=null,this.showInfo=r,this.setMap(this.map_)}n.prototype.MARKER_CLUSTER_IMAGE_PATH_="../images/m",n.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png",n.prototype.extend=function(t,e){return function(t){for(var e in t.prototype)this.prototype[e]=t.prototype[e];return this}.apply(t,[e])},n.prototype.onAdd=function(){this.setReady_(!0)},n.prototype.draw=function(){},n.prototype.setupStyles_=function(){if(!this.styles_.length)for(var t,e=0;t=this.sizes[e];e++)this.styles_.push({url:this.imagePath_+(e+1)+"."+this.imageExtension_,height:t,width:t})},n.prototype.fitMapToMarkers=function(){for(var t,e=this.getMarkers(),n=new google.maps.LatLngBounds,r=0;t=e[r];r++)n.extend(t.getPosition());this.map_.fitBounds(n)},n.prototype.setStyles=function(t){this.styles_=t},n.prototype.getStyles=function(){return this.styles_},n.prototype.isZoomOnClick=function(){return this.zoomOnClick_},n.prototype.isAverageCenter=function(){return this.averageCenter_},n.prototype.getMarkers=function(){return this.markers_},n.prototype.getTotalMarkers=function(){return this.markers_.length},n.prototype.setMaxZoom=function(t){this.maxZoom_=t},n.prototype.getMaxZoom=function(){return this.maxZoom_},n.prototype.calculator_=function(t,e){for(var n=0,r=t.length,s=r;0!==s;)s=parseInt(s/10,10),n++;return n=Math.min(n,e),{text:r,index:n}},n.prototype.setCalculator=function(t){this.calculator_=t},n.prototype.getCalculator=function(){return this.calculator_},n.prototype.addMarkers=function(t,e){for(var n,r=0;n=t[r];r++)this.pushMarkerTo_(n);e||this.redraw()},n.prototype.pushMarkerTo_=function(t){if(t.isAdded=!1,t.draggable){var e=this;google.maps.event.addListener(t,"dragend",function(){t.isAdded=!1,e.repaint()})}this.markers_.push(t)},n.prototype.addMarker=function(t,e){this.pushMarkerTo_(t),e||this.redraw()},n.prototype.removeMarker_=function(t){var e=-1;if(this.markers_.indexOf)e=this.markers_.indexOf(t);else for(var n,r=0;n=this.markers_[r];r++)if(n==t){e=r;break}return-1!=e&&(t.setMap(null),this.markers_.splice(e,1),!0)},n.prototype.removeMarker=function(t,e){var n=this.removeMarker_(t);return!(e||!n)&&(this.resetViewport(),this.redraw(),!0)},n.prototype.removeMarkers=function(t,e){for(var n,r=!1,s=0;n=t[s];s++){var a=this.removeMarker_(n);r=r||a}if(!e&&r)return this.resetViewport(),this.redraw(),!0},n.prototype.setReady_=function(t){this.ready_||(this.ready_=t,this.createClusters_())},n.prototype.getTotalClusters=function(){return this.clusters_.length},n.prototype.getMap=function(){return this.map_},n.prototype.setMap=function(t){this.map_=t},n.prototype.getGridSize=function(){return this.gridSize_},n.prototype.setGridSize=function(t){this.gridSize_=t},n.prototype.getMinClusterSize=function(){return this.minClusterSize_},n.prototype.setMinClusterSize=function(t){this.minClusterSize_=t},n.prototype.getExtendedBounds=function(t){var e=this.getProjection(),n=new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()),r=new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()),s=e.fromLatLngToDivPixel(n);s.x+=this.gridSize_,s.y-=this.gridSize_;var a=e.fromLatLngToDivPixel(r);a.x-=this.gridSize_,a.y+=this.gridSize_;var o=e.fromDivPixelToLatLng(s),i=e.fromDivPixelToLatLng(a);return t.extend(o),t.extend(i),t},n.prototype.isMarkerInBounds_=function(t,e){return e.contains(t.getPosition())},n.prototype.clearMarkers=function(){this.hideAllClusterInfo(),this.resetViewport(!0),this.markers_=[]},n.prototype.resetViewport=function(t){this.hideAllClusterInfo();for(var e,n=0;e=this.clusters_[n];n++)e.remove();for(var r,n=0;r=this.markers_[n];n++)r.isAdded=!1,t&&r.setMap(null);this.clusters_=[]},n.prototype.repaint=function(){var t=this.clusters_.slice();this.clusters_.length=0,this.resetViewport(),this.redraw(),window.setTimeout(function(){for(var e,n=0;e=t[n];n++)e.remove()},0)},n.prototype.redraw=function(){this.createClusters_()},n.prototype.distanceBetweenPoints_=function(t,e){if(!t||!e)return 0;var n=(e.lat()-t.lat())*Math.PI/180,r=(e.lng()-t.lng())*Math.PI/180,s=Math.sin(n/2)*Math.sin(n/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(e.lat()*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371},n.prototype.addToClosestCluster_=function(t){for(var e,n=4e4,s=null,a=(t.getPosition(),0);e=this.clusters_[a];a++){var o=e.getCenter();if(o){var i=this.distanceBetweenPoints_(o,t.getPosition());i<n&&(n=i,s=e)}}if(s&&s.isMarkerInClusterBounds(t))s.addMarker(t);else{var e=new r(this);e.setShowInfo(this.showInfo),e.addMarker(t),this.clusters_.push(e)}},n.prototype.createClusters_=function(){if(this.ready_)for(var t,e=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast()),n=this.getExtendedBounds(e),r=0;t=this.markers_[r];r++)!t.isAdded&&this.isMarkerInBounds_(t,n)&&this.addToClosestCluster_(t)},n.prototype.hideAllClusterInfo=function(){for(var t,e=0;t=this.clusters_[e];e++)t.closeAllInfo()},n.prototype.setShowInfo=function(t){this.showInfo=t;for(var e,n=0;e=this.clusters_[n];n++)e.setShowInfo(t),t||e.closeAllInfo()},r.prototype.closeAllInfo=function(){this.clusterIcon_.closeAllInfo()},r.prototype.setShowInfo=function(t){this.clusterIcon_.showInfo=t},r.prototype.isMarkerAlreadyAdded=function(t){if(this.markers_.indexOf)return-1!=this.markers_.indexOf(t);for(var e,n=0;e=this.markers_[n];n++)if(e==t)return!0;return!1},r.prototype.addMarker=function(t){if(this.isMarkerAlreadyAdded(t))return!1;if(this.center_){if(this.averageCenter_){var e=this.markers_.length+1,n=(this.center_.lat()*(e-1)+t.getPosition().lat())/e,r=(this.center_.lng()*(e-1)+t.getPosition().lng())/e;this.center_=new google.maps.LatLng(n,r),this.calculateBounds_()}}else this.center_=t.getPosition(),this.calculateBounds_();t.isAdded=!0,this.markers_.push(t);var s=this.markers_.length;if(s<this.minClusterSize_&&t.getMap()!=this.map_&&t.setMap(this.map_),s==this.minClusterSize_)for(var a=0;a<s;a++)this.markers_[a].setMap(null);return s>=this.minClusterSize_&&t.setMap(null),this.updateIcon(),this.infoWindowStr=(this.infoWindowStr?this.infoWindowStr+"<hr>":"")+t.infoWindowStr,!0},r.prototype.getMarkerClusterer=function(){return this.markerClusterer_},r.prototype.getBounds=function(){for(var t,e=new google.maps.LatLngBounds(this.center_,this.center_),n=this.getMarkers(),r=0;t=n[r];r++)e.extend(t.getPosition());return e},r.prototype.remove=function(){this.clusterIcon_.remove(),this.markers_.length=0,delete this.markers_},r.prototype.getSize=function(){return this.markers_.length},r.prototype.getMarkers=function(){return this.markers_},r.prototype.getCenter=function(){return this.center_},r.prototype.calculateBounds_=function(){var t=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(t)},r.prototype.isMarkerInClusterBounds=function(t){return this.bounds_.contains(t.getPosition())},r.prototype.getMap=function(){return this.map_},r.prototype.updateIcon=function(){var t=this.map_.getZoom(),e=this.markerClusterer_.getMaxZoom();if(e&&t>e)for(var n,r=0;n=this.markers_[r];r++)n.setMap(this.map_);else{if(this.markers_.length<this.minClusterSize_)return void this.clusterIcon_.hide();var s=this.markerClusterer_.getStyles().length,a=this.markerClusterer_.getCalculator()(this.markers_,s);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.setSums(a),this.clusterIcon_.show()}},s.prototype.triggerClusterClick=function(t){var e=this.cluster_.getMarkerClusterer();google.maps.event.trigger(e,"clusterclick",this.cluster_,t),e.isZoomOnClick()&&this.map_.fitBounds(this.cluster_.getBounds());var n=new google.maps.Marker({position:this.cluster_.center_,map:this.map_,title:"Cluster Multiple addresses"});this.cluster_.clusterIcon_.infowindow.open(this.map_,n)},s.prototype.onAdd=function(){if(this.div_=document.createElement("DIV"),this.visible_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(t),this.div_.innerHTML=this.sums_.text}this.getPanes().overlayMouseTarget.appendChild(this.div_);var e=this,n=!1;google.maps.event.addDomListener(this.div_,"click",function(t){n||e.triggerClusterClick(t)}),google.maps.event.addDomListener(this.div_,"mousedown",function(){n=!1}),google.maps.event.addDomListener(this.div_,"mousemove",function(){n=!0}),this.infowindow=new google.maps.InfoWindow({content:"<div id='info-window'>"+this.cluster_.infoWindowStr+"</div>"});var r=this.map_,s=this.center_,a=this.infowindow;this.showInfo;google.maps.event.addDomListener(this.div_,"mouseover",function(){e.showInfo&&(a.setPosition(s),a.open(r))})},s.prototype.closeAllInfo=function(){this.infowindow&&this.infowindow.close(this.map_)},s.prototype.getPosFromLatLng_=function(t){var e=this.getProjection().fromLatLngToDivPixel(t);return"object"==typeof this.iconAnchor_&&2===this.iconAnchor_.length?(e.x-=this.iconAnchor_[0],e.y-=this.iconAnchor_[1]):(e.x-=parseInt(this.width_/2,10),e.y-=parseInt(this.height_/2,10)),e},s.prototype.draw=function(){if(this.visible_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.top=t.y+"px",this.div_.style.left=t.x+"px"}},s.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},s.prototype.show=function(){if(this.div_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(t),this.div_.style.display=""}this.visible_=!0},s.prototype.remove=function(){this.setMap(null)},s.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),this.div_.parentNode.removeChild(this.div_),this.div_=null)},s.prototype.setSums=function(t){this.sums_=t,this.text_=t.text,this.index_=t.index,this.div_&&(this.div_.innerHTML=t.text),this.useStyle()},s.prototype.useStyle=function(){var t=Math.max(0,this.sums_.index-1);t=Math.min(this.styles_.length-1,t);var e=this.styles_[t];this.url_=e.url,this.height_=e.height,this.width_=e.width,this.textColor_=e.textColor,this.anchor_=e.anchor,this.textSize_=e.textSize,this.backgroundPosition_=e.backgroundPosition,this.iconAnchor_=e.iconAnchor},s.prototype.setCenter=function(t){this.center_=t},s.prototype.createCss=function(t){var e=[];e.push("background-image:url("+this.url_+");");var n=this.backgroundPosition_?this.backgroundPosition_:"0 0";e.push("background-position:"+n+";"),"object"==typeof this.anchor_?("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?e.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;"):"number"==typeof this.anchor_[0]&&this.anchor_[0]<0&&-this.anchor_[0]<this.height_?e.push("height:"+this.height_+"px; line-height:"+(this.height_+this.anchor_[0])+"px;"):e.push("height:"+this.height_+"px; line-height:"+this.height_+"px;"),"number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?e.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;"):e.push("width:"+this.width_+"px; text-align:center;")):e.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;");var r=this.textColor_?this.textColor_:"black",s=this.textSize_?this.textSize_:11;return e.push("cursor:pointer; top:"+t.y+"px; left:"+t.x+"px; color:"+r+"; position:absolute; font-size:"+s+"px; font-family:Arial,sans-serif; font-weight:bold"),e.join("")},window.MarkerClusterer=n,n.prototype.addMarker=n.prototype.addMarker,n.prototype.addMarkers=n.prototype.addMarkers,n.prototype.clearMarkers=n.prototype.clearMarkers,n.prototype.fitMapToMarkers=n.prototype.fitMapToMarkers,n.prototype.getCalculator=n.prototype.getCalculator,n.prototype.getGridSize=n.prototype.getGridSize,n.prototype.getExtendedBounds=n.prototype.getExtendedBounds,n.prototype.getMap=n.prototype.getMap,n.prototype.getMarkers=n.prototype.getMarkers,n.prototype.getMaxZoom=n.prototype.getMaxZoom,n.prototype.getStyles=n.prototype.getStyles,n.prototype.getTotalClusters=n.prototype.getTotalClusters,n.prototype.getTotalMarkers=n.prototype.getTotalMarkers,n.prototype.redraw=n.prototype.redraw,n.prototype.removeMarker=n.prototype.removeMarker,n.prototype.removeMarkers=n.prototype.removeMarkers,n.prototype.resetViewport=n.prototype.resetViewport,n.prototype.repaint=n.prototype.repaint,n.prototype.setCalculator=n.prototype.setCalculator,n.prototype.setGridSize=n.prototype.setGridSize,n.prototype.setMaxZoom=n.prototype.setMaxZoom,n.prototype.onAdd=n.prototype.onAdd,n.prototype.draw=n.prototype.draw,n.prototype.hideAllClusterInfo=n.prototype.hideAllClusterInfo,n.prototype.setShowInfo=n.prototype.setShowInfo,r.prototype.getCenter=r.prototype.getCenter,r.prototype.getSize=r.prototype.getSize,r.prototype.getMarkers=r.prototype.getMarkers,r.prototype.closeAllInfo=r.prototype.closeAllInfo,r.prototype.setShowInfo=r.prototype.setShowInfo,s.prototype.onAdd=s.prototype.onAdd,s.prototype.draw=s.prototype.draw,s.prototype.onRemove=s.prototype.onRemove,s.prototype.closeAllInfo=s.prototype.closeAllInfo},"Z/XM":function(t,e){t.exports='<form name=\'addrForm\' #addrForm="ngForm">\r\n  <div mat-dialog-content>\r\n    \x3c!-- Normal dialog --\x3e\r\n    <ng-container *ngIf="data.consumer.isEditStatus()">\r\n      <div flex="" layout="row" layout-align="center center" style="margin-top:5px;">\r\n        <button *ngIf="data.consumer.currentGmapUrl && data.consumer.mapStarted" mat-fab (click)="data.consumer.saveStatus()" style="margin-right:5px;"><mat-icon>save</mat-icon></button>\r\n        <a *ngIf="data.consumer.currentGmapUrl" target="_blank" href="{{ data.consumer.currentGmapUrl }}" mat-fab style="margin-right:5px;"><mat-icon svgIcon="google-map"></mat-icon></a>\r\n        <a *ngIf="!data.consumer.hasMultiAdds() && !data.consumer.isUpdater()" href="{{ data.consumer.currentFeedbackUrl }}" target="_blank" mat-fab style="margin-right:5px;"><mat-icon svgIcon="edit-address"></mat-icon></a>\r\n        <button *ngIf="data.consumer.isUpdater() && !data.consumer.hasMultiAdds()" (click)="data.consumer.setEditingAddress();data.consumer.enableEditAddress()" mat-fab style="margin-right:5px;"><mat-icon svgIcon="edit-address"></mat-icon></button>\r\n        <button mat-fab (click)="data.consumer.cancelAddrDlg()"><mat-icon>cancel</mat-icon></button>\r\n      </div>\r\n      <mat-card *ngIf="data.consumer.mapStarted">\r\n        <mat-card-content>\r\n          <div><h3>{{ data.consumer.currentAddrTitle }} </h3></div>\r\n          <div *ngIf="data.consumer.isNotAtHome() && data.consumer.hasDetail()"><h4>Last Visited: {{ data.consumer.getLastVisited() | date:\'EEE, hh:mm a, dd MMM y\' }} </h4></div>\r\n          <div *ngIf=" data.consumer.currentAddr.addObj.tel"><h5>PH: {{ data.consumer.currentAddr.addObj.tel }}</h5></div>\r\n          <mat-radio-group *ngIf="!data.consumer.hasMultiAdds() && data.consumer.selectedAddObj" class="addrstat-radio-group" name="stat" [(ngModel)]="data.consumer.selectedAddObj.status">\r\n            <mat-radio-button class="addrstat-radio-button" *ngFor="let stat of data.consumer.addrStatuses" [value]="stat.val">\r\n              {{ stat.label }}\r\n            </mat-radio-button>\r\n          </mat-radio-group>\r\n          <mat-list *ngIf="data.consumer.hasMultiAdds()">\r\n            <mat-list-item *ngFor="let addObj of data.consumer.currentAddr.addObj">\r\n              <button mat-raised-button [style.color]="data.consumer.getStatusFgColor(addObj)" [style.background-color]="data.consumer.getStatusBgColor(addObj)" (click)="data.consumer.selectAdd(addObj)"> {{ data.consumer.getAddressTitle(addObj) }} </button>\r\n            </mat-list-item>\r\n          </mat-list>\r\n        </mat-card-content>\r\n      </mat-card>\r\n      <mat-card *ngIf="!data.consumer.mapStarted">\r\n        <mat-card-content>\r\n          <span><h3>{{ data.consumer.currentAddrTitle }} </h3></span>\r\n          <div *ngIf="!data.consumer.isUpdater()">\r\n              If you are expecting to work on this map, please ask any map updaters to assign this map to an owner.\r\n          </div>\r\n          <mat-list *ngIf="data.consumer.isUpdater() && data.consumer.hasMultiAdds()">\r\n            <mat-list-item *ngFor="let addObj of data.consumer.currentAddr.addObj">\r\n              <button mat-raised-button color="accent" (click)="data.consumer.setEditingAddress(); data.consumer.selectAdd(addObj);"> {{ data.consumer.getAddressTitle(addObj) }} </button>\r\n            </mat-list-item>\r\n          </mat-list>\r\n        </mat-card-content>\r\n      </mat-card>\r\n    </ng-container>\r\n    \x3c!-- Admin Edit address mode version --\x3e\r\n    <ng-container *ngIf="data.consumer.isEditModeAddress()">\r\n      <div flex="" layout="row" layout-align="center center" style="margin-top:5px;">\r\n        <button mat-fab [disabled]="!addrForm.valid" (click)="data.consumer.saveAddressEdit()" style="margin-right:5px;"><mat-icon>save</mat-icon></button>\r\n        <button mat-fab (click)="data.consumer.cancelAddrDlg()"><mat-icon>cancel</mat-icon></button>\r\n      </div>\r\n      <mat-card>\r\n        <mat-card-content>\r\n          \x3c!-- Address edit mode --\x3e\r\n          <div class="address-edit-container" *ngIf="!data.consumer.hasMultiAdds() && data.consumer.selectedAddObj; let addObj">\r\n            <ng-container *ngIf="data.consumer.selectedAddObj; let addObj">\r\n              <span><h3><a href="/map/{{addObj.mapId}}" target="_blank">{{ data.consumer.getAddressTitle(addObj) }}</a></h3></span>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Unit" name="unit" [(ngModel)]="addObj.unit">\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="House Number" name="hnum" [(ngModel)]="addObj.hnum" required>\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Street" name="st" [(ngModel)]="addObj.st" required>\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Suburb" name="burb" [(ngModel)]="addObj.burb" required>\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Zipcode" name="pcode" [(ngModel)]="addObj.pcode" required>\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Latitude" name="clat" [(ngModel)]="addObj.clat" required>\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Longitude" name="clong" [(ngModel)]="addObj.clong" required>\r\n              </mat-form-field>\r\n              <mat-form-field>\r\n                <input matInput placeholder="Phone" name="tel" [(ngModel)]="addObj.tel">\r\n              </mat-form-field>\r\n              <mat-divider></mat-divider>\r\n            </ng-container>\r\n          </div>\r\n        </mat-card-content>\r\n      </mat-card>\r\n    </ng-container>\r\n    \x3c!-- Move Address --\x3e\r\n  </div>\r\n</form>\r\n'},Z2wb:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,".mapCard{margin-top:10px;margin-bottom:10px}",""]),t.exports=t.exports.toString()},aHcY:function(t,e,n){"use strict";var r=n("/oeL"),s=n("a0oU"),a=n("wINU"),o=n("0o1w"),i=n("qbdv"),d=n("bm2B"),c=n("GsmQ"),u=n("HAwn"),p=n("hoZb"),l=n("xwLn"),m=n("6lRS"),h=n("Htvr"),f=n("BkNc"),g=n("HbVw"),b=n("Dcui"),y=n("CKBp"),v=n("cn2Z"),M=(n.n(v),n("fL27")),O=n("CPp0"),A=n("eb9A"),j=n("p5Ee");n.d(e,"a",function(){return _});var w=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},_=function(){function t(){}return t}();_=w([n.i(r.NgModule)({imports:[i.CommonModule,d.FormsModule,M.a,v.TagInputModule,s.a.forRoot({apiKey:j.a.agm.api}),u.b,m.l,m.m,m.j,m.n,m.o,m.f,m.k,m.p,m.h,m.q,m.r,m.i,m.s,m.t,m.u,O.b,f.a,h.a,h.b,g.a,m.v,m.g,m.w],declarations:[a.a,o.a,l.a,p.a,y.a,y.b,a.b,a.c,y.c,A.a,a.d],exports:[a.a,o.a,y.a,y.b,a.b,a.c,y.c,l.a,A.a,a.d],providers:[c.a,b.a],entryComponents:[p.a,y.b,a.b,a.c,y.c,A.a,a.d]})],_)},"aR8+":function(t,e,n){"use strict";var r=n("fc+i"),s=n("/oeL"),a=n("fL27"),o=n("Iqat"),i=n("rgUS"),d=(n.n(i),n("wQAS")),c=n("ktAp"),u=n("6lRS");n.d(e,"a",function(){return l});var p=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},l=function(){function t(){}return t}();l=p([n.i(s.NgModule)({declarations:[d.a],imports:[r.a,a.a,c.a,o.a],providers:[{provide:u.a,useValue:!0}],bootstrap:[d.a]})],l)},cDNt:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("/oeL"),s=n("Qa4U"),a=n("aR8+");n("p5Ee").a.production&&n.i(r.enableProdMode)(),n.i(s.a)().bootstrapModule(a.a)},cukb:function(t,e){t.exports='<div mat-dialog-content>\r\n\r\n      <span><h3>{{ data.consumer.title }} </h3></span>\r\n      <table width="100%">\r\n        <tr>\r\n            <td><strong>Address & Phone</strong></td>\r\n            <td width="110px;" *ngIf="data.consumer.mapStarted"><strong>Status</strong></td>\r\n            <td *ngIf="data.consumer.fireAuth.currentUser.isAdmin() || data.consumer.fireAuth.currentUser.isUpdater()">\r\n              <strong>Actions</strong>\r\n            </td>\r\n        </tr>\r\n        <tr *ngFor="let addObj of data.consumer.currentAddrList">\r\n          <td >\r\n            <a target="_blank" href="{{ data.consumer.getGmapUrl(addObj) }}" >\r\n              {{ data.consumer.getAddressTitle(addObj) }}\r\n            </a>\r\n            <ng-container *ngIf="addObj.tel">\r\n              <br/>\r\n              PH: {{ addObj.tel }}\r\n            </ng-container>\r\n          </td>\r\n          <td *ngIf="data.consumer.mapStarted">\r\n            <mat-select [(ngModel)]="addObj.status" [style.font-weight]="\'bold\'" [style.background-color]="data.consumer.getStatusBgColor(addObj)">\r\n              <ng-container *ngFor="let stat of data.consumer.addrStatuses">\r\n                <mat-option [value]="stat.val" >{{stat.label}}</mat-option>\r\n              </ng-container>\r\n            </mat-select>\r\n          </td>\r\n          <td *ngIf="data.consumer.fireAuth.currentUser.isAdmin() || data.consumer.fireAuth.currentUser.isUpdater()">\r\n            <a href="#" (click)="data.consumer.editAddress($event, addObj)">Edit</a>\r\n            &nbsp;\r\n            <a href="#" (click)="data.consumer.deleteAddress($event, addObj)">Delete</a>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n      <br/>\r\n      <button mat-fab *ngIf="data.consumer.mapStarted" (click)="data.consumer.saveStatuses()" ><mat-icon>save</mat-icon></button>\r\n      <button mat-fab (click)="data.consumer.closeAddrListDlg()"><mat-icon>cancel</mat-icon></button>\r\n</div>\r\n'},dCN4:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},eb9A:function(t,e,n){"use strict";var r=n("/oeL"),s=n("GsmQ"),a=n("Dqrr"),o=(n.n(a),n("p5Ee")),i=n("6lRS"),d=n("xrDH"),c=(n.n(d),n("Dcui")),u=n("HGbW"),p=n("0+Pn");n.d(e,"a",function(){return f});var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},h=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=function(t){function e(e,n,r,s){var a=t.call(this)||this;return a.mapService=r,a.winRef=s,a.appTitle=o.a.app.title,a.newDataType=null,a.searchDataType="address",a.isBusy=!1,a.displayedColumns=["fullSt","burb","map","fsg"],a.mapBin={},a.mapIds=[],a.dialog=e,a.fireAuth=n,a}return l(e,t),e.prototype.ngOnInit=function(){var t=this;this.mapService.getAllFsgMaps(this.mapBin).flatMap(function(t){return a.Observable.of(null)}).debounce(function(){return a.Observable.interval(1e3)}).subscribe(function(){d.forOwn(t.mapBin,function(e,n){t.mapIds.push(e)}),t.fsgs=d.uniq(d.map(t.mapIds,function(t){return t.fsgName}))}),this.mapService.getMetadata().subscribe(function(t){})},e.prototype.saveNewData=function(){var t=this,e=this;if("fsg"==this.newDataType){if(d.find(this.fsgs,function(e){return e==t.fsgName}))return void(this.msg="Name already exists.");this.isBusy=!0,this.mapService.addNewFsg(this.fsgName,function(){e.msg="FSG Successfully Added!",e.isBusy=!1})}"map"==this.newDataType&&(this.isBusy=!0,this.mapService.addNewMap(this.fsgName,this.mapName,!1,function(){e.msg="Map Successfully Added!",e.isBusy=!1}))},e.prototype.searchData=function(){var t=this;this.isBusy=!0,this.showLoadingDialog();"address"==this.searchDataType&&(console.log("Finding: "+this.stName),this.mapService.findByStreet(this.stName,function(e){console.log(e),t.isBusy=!1;var n=[];d.forOwn(e,function(t,e){t.addId=e,t.fullSt=(t.unit&&-9!=t.unit?t.unit+"/":"")+" "+t.hnum+" "+t.st,n.push(t)}),t.searchRes=n,t.hideLoadingDialog()}))},e}(u.a);f=m([n.i(r.Component)({selector:"map-admin-component",template:n("4wwY")}),h("design:paramtypes",["function"==typeof(g=void 0!==i.b&&i.b)&&g||Object,"function"==typeof(b=void 0!==p.a&&p.a)&&b||Object,"function"==typeof(y=void 0!==s.a&&s.a)&&y||Object,"function"==typeof(v=void 0!==c.a&&c.a)&&v||Object])],f);var g,b,y,v},efyd:function(t,e){t.exports="\x3c!--The whole content below can be removed with the new code.--\x3e\r\n<div mat-app-background>\r\n  <router-outlet></router-outlet>\r\n</div>\r\n"},hoZb:function(t,e,n){"use strict";var r=n("6lRS"),s=n("/oeL");n.d(e,"a",function(){return i});var a=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},o=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},i=function(){function t(t){this.dialogRef=t}return t}();i=a([n.i(s.Component)({selector:"loading-dialog",template:'\n            <div mat-dialog-content>\n              <div class="flex-container"\n               fxLayout="column"\n               fxLayout.xs="column"\n               fxLayoutAlign="center center"\n               fxLayoutAlign.xs="start">\n                  <img src="/assets/images/pie-loader.svg">\n               </div>\n            </div>\n            '}),o("design:paramtypes",["function"==typeof(d=void 0!==r.d&&r.d)&&d||Object])],i);var d},hxJY:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"*{font-family:Roboto,sans-serif}.mat-dialog-container{max-height:70vh!important}",""]),t.exports=t.exports.toString()},ivJn:function(t,e){t.exports='\r\n<td-message *ngIf="!hasMaps" label="Info" sublabel="You have no maps, please contact the maps team if you are expecting maps." color="accent" icon="info"></td-message>\r\n<ng-container *ngFor="let fsg of fsgMaps; index as i ">\r\n  <td-expansion-panel #tdPanel (expanded)="toggleExpand(fsg, true)" (collapsed)="toggleExpand(fsg, false)" >\r\n    {{ addFsgComp(fsg, i, tdPanel) }}\r\n    <ng-template td-expansion-panel-header>\r\n      <mat-toolbar [ngClass]="\'bgc-blue-grey-600 whiteText marginTopBottom-2\'">\r\n        <span><h2>{{ getFsgName(fsg) }}</h2> </span>\r\n        <span class="fill-remaining-space"></span>\r\n        <span><mat-icon *ngIf="!fsg.expanded">keyboard_arrow_down</mat-icon><mat-icon *ngIf="fsg.expanded">keyboard_arrow_up</mat-icon></span>\r\n      </mat-toolbar>\r\n    </ng-template>\r\n    <mat-card class=\'mapCard\' *ngFor="let map of fsg.maps" [style.background-color]="getBgMap(map)">\r\n      <mat-card-header>\r\n        <mat-card-title>\r\n          <h3>\r\n            <a *ngIf="canOpenMap(map); else elseBlock" [routerLink]="[\'/map\', map.id]">\r\n              {{map.mapObj.terId}} - {{map.mapObj.name}} {{ isNormalMode() ? \'\' : \'::: Campaign\'}}\r\n            </a>\r\n            <ng-template #elseBlock >\r\n              {{map.mapObj.terId}} - {{map.mapObj.name}} {{ isNormalMode() ? \'\' : \'::: Campaign\'}}\r\n            </ng-template>\r\n          </h3>\r\n        </mat-card-title>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <mat-progress-bar class="marginBottom-10" *ngIf="map.assgnObj && map.assgnObj.started" [value]="getCompletionPercentage(map)" [color]="primary"></mat-progress-bar>\r\n        <div>\r\n          <mat-chip-list selectable="false">\r\n            <mat-chip *ngIf="map.assgnObj && map.assgnObj.started">Remaining: {{ getRemaining(map) }}</mat-chip>\r\n            <mat-chip>Addresses: {{map.addressCount}}</mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj && map.assgnObj.lastSaved">Last used on: {{ map.assgnObj.lastSaved.when  | date:\'EEEE, hh:mm a, dd MMM y\' }} </mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj && map.assgnObj.lastSaved">Last used by: {{ map.assgnObj.lastSaved.name }}</mat-chip>\r\n            <mat-chip *ngIf="map.hasOwner()">Owner: {{ map.getOwner().name}} </mat-chip>\r\n            <mat-chip *ngIf="map.hasUsers()">Users: {{ getMapUsers(map) }}</mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj && map.assgnObj.started">Started: {{ map.assgnObj.started | date:\'dd MMM y\'}}</mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj && map.assgnObj.expiry" [style.background-color]="getBg(map.assgnObj.expiry)" >Expiry: {{ map.assgnObj.expiry | date:\'dd MMM y\'}}</mat-chip>\r\n            <mat-chip *ngIf="map.mapObj.lastCompleted && isUpdater() && isNormalMode()">Last completed: {{ map.mapObj.lastCompleted | date:\'dd MMM y\'}}</mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj.prevOwner && isUpdater()" >Last Owner: {{ map.assgnObj.prevOwner.name }}</mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj.isPersonal">Personal Territory</mat-chip>\r\n            <mat-chip *ngIf="map.assgnObj.notes">{{ map.assgnObj.notes }}</mat-chip>\r\n          </mat-chip-list>\r\n        </div>\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <a *ngIf="canOpenMap(map)" mat-mini-fab [routerLink]="[\'/map\', map.id]"><mat-icon>map</mat-icon></a>\r\n        <mapshare *ngIf="canOpenMap(map)" [map]="map" [campaignMode]="!isNormalMode()"></mapshare>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n  </td-expansion-panel>\r\n</ng-container>\r\n<mat-card *ngIf="metadata">\r\n  <mat-card-header>\r\n    <mat-card-title>\r\n      <h3>\r\n        Progress Report\r\n      </h3>\r\n    </mat-card-title>\r\n  </mat-card-header>\r\n  <mat-card-content>\r\n    <h4 *ngIf="metadata.mode.campaign">Days left for this campaign: {{ getCompletionReport().daysLeft }} days</h4>\r\n    <h4>Current overall map completion: {{ getOverallCompletion() }}% ( {{ getCompletionReport().completedMaps }} of {{ getMapCount() }} maps )</h4>\r\n    <h4>Current number addresses visited: {{ getCompletionReport().completionAddr }}% ( {{ getCompletionReport().visitedAddresses }} of {{ getCompletionReport().totalAddresses }} addresses )</h4>\r\n  </mat-card-content>\r\n</mat-card>\r\n'},ktAp:function(t,e,n){"use strict";var r=n("qbdv"),s=n("/oeL"),a=n("bm2B"),o=n("6lRS"),i=n("SAdc"),d=n("+tBu"),c=n("HbVw"),u=n("aHcY"),p=n("r0ix"),l=n("BkNc");n.d(e,"a",function(){return h});var m=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},h=function(){function t(){}return t}();h=m([n.i(s.NgModule)({imports:[r.CommonModule,a.FormsModule,o.f,o.g,o.h,o.i,o.j,o.k,p.a,o.l,c.a,u.a,l.a],declarations:[i.a,d.a,i.b],exports:[r.CommonModule,a.FormsModule,u.a,i.a,d.a,c.a],providers:[],entryComponents:[d.a,i.b]})],h)},l1II:function(t,e){t.exports='<span *ngIf="isUpdater()">\r\n  <button mat-icon-button [matMenuTriggerFor]="menu" >\r\n    <mat-icon>more_vert</mat-icon>\r\n  </button>\r\n<mat-menu #menu="matMenu" >\r\n  <button mat-menu-item (click)="resetPassword()">\r\n    <mat-icon>person_outline</mat-icon>\r\n    <span>Reset Password</span>\r\n  </button>\r\n  <button mat-menu-item (click)="addUser()">\r\n    <mat-icon>person_add</mat-icon>\r\n    <span>Add User</span>\r\n  </button>\r\n  <button mat-menu-item (click)="showVersionDlg()">\r\n    <mat-icon>info_outline</mat-icon>\r\n    <span>Release Notes</span>\r\n  </button>\r\n  <button mat-menu-item (click)="logout()">\r\n    <mat-icon>exit_to_app</mat-icon>\r\n    <span>Logout</span>\r\n  </button>\r\n</mat-menu>\r\n</span>\r\n<span *ngIf="!isUpdater()" style="margin-left: 5px;">\r\n  <button mat-icon-button [matMenuTriggerFor]="menu" >\r\n    <mat-icon>more_vert</mat-icon>\r\n  </button>\r\n  <mat-menu #menu="matMenu" >\r\n    <button mat-menu-item (click)="showVersionDlg()">\r\n      <mat-icon>info_outline</mat-icon>\r\n      <span>Release Notes</span>\r\n    </button>\r\n    <button mat-menu-item (click)="logout()">\r\n      <mat-icon>exit_to_app</mat-icon>\r\n      <span>Logout</span>\r\n    </button>\r\n  </mat-menu>\r\n</span>\r\n'},mPw8:function(t,e,n){"use strict";var r=n("/oeL"),s=n("0+Pn"),a=n("HGbW");n.d(e,"a",function(){return c});var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},d=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(t){function e(e){var n=t.call(this)||this;return n.fireAuth=e,n.subs=[],n}return o(e,t),e.prototype.ngOnInit=function(){var t=this;this.user=this.fireAuth.currentUser,this.subs.push(this.fireAuth.onCurrentUserInfo.subscribe(function(e){t.user=t.fireAuth.currentUser,console.log("User info:"),console.log(t.user)}))},e}(a.a);c=i([n.i(r.Component)({selector:"userinfo",template:n("SicF")}),d("design:paramtypes",["function"==typeof(u=void 0!==s.a&&s.a)&&u||Object])],c);var u},n7du:function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="n7du"},p5Ee:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r={production:!0,addressFeedBackForm:"https://docs.google.com/forms/d/e/1FAIpQLSdZYe2BmeJ_DLwW1lbvu9bcLWe7_wZ3Rs5fdaw-q4g9zfys3g/viewform",agm:{api:"AIzaSyD_VnDujye_oVKyUnExhT3LqETfARNIoiw"},app:{title:"Toowong Ministry Maps",mapBase:"https://maps-toowong.jwapp.xyz/#"},firebase:{apiKey:"AIzaSyAc-LpdSNpZhfykfAsjYn3Ze9s0_wR58ts",authDomain:"toowong-maps-prod.firebaseapp.com",databaseURL:"https://toowong-maps-prod.firebaseio.com",projectId:"toowong-maps-prod",storageBucket:"toowong-maps-prod.appspot.com",messagingSenderId:"1055117975996"},version:{current:"2.92.0",list:["2.92.0","2.91.3","2.91.2","2.91.1","2.91.0","2.90.5","2.90.4","2.90.3","2.90.2","2.90.1","2.90","2.89.1","2.89","2.88","2.87","2.86","2.85","2.84","2.83","2.82","2.8.1","2.8","2.7.1","2.7"],details:{"2.92.0":"Emergency update: Displayed phone number data if this is available, in address list dialog and edit status dialog.","2.91.3":"Bugfix: address list now shows multiple addresses on both editing address or editing status.","2.91.2":"Bugfix: For updaters, fixed adding new addresses when map is started.","2.91.1":"Address list dialog: fixed editing, and suppressed status column when map is not started.","2.91.0":"Changed multiple address background colours to match the status. Updaters can now edit & delete addresses from the dialog list, and delete maps.","2.90.5":"Bugfix: fixed address dialog issue.","2.90.4":"Bugfix: fixed editing addresses from the same GPS marker.","2.90.3":"Showed individual addresses on clusters. Suppressed Queued FSG when showing All maps","2.90.2":"Fixed moving addresses from old maps that use lists in addresses, instead of the newer map-based.","2.90.1":"Fixed add address dialog issue. Handled null street address on maps.","2.90":"Added search and edit map for map updaters","2.89.1":"Remove not-at-homes on campaign mode",2.89:"Last used on chip now shows the day of the week, as well as the time.",2.88:"Added more updater features",2.87:"Fixed status issue",2.86:"Improved in-app map links, search maps are no longer limited to being visited twice, and are now processed semi-automatically. Added address queues.",2.85:'Supports language surveys when marking addresses as "Done".',2.84:"Allowed setting of ownership on started maps. Added tag for personal territories. Added notes field for map updaters.",2.83:"Added personal territory flag when assigning ownership. Added link to Google Maps from address list. ",2.82:"Address list dialog now allows editing of addresses. Improved progress report.","2.8.1":"Improved progress report information.",2.8:"Added territory coverage information to the home page. Added release notes to the menu, logout button now part of the menu.","2.7.1":"Fixed map sharing feature.",2.7:"Campaign mode added. For map updaters, completed maps are now grayed out and cannot be easily started."}}}},rHti:function(t,e,n){function r(t){return n(s(t))}function s(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./af":"+OfC","./af.js":"+OfC","./ar":"IOJo","./ar-dz":"2rVV","./ar-dz.js":"2rVV","./ar-kw":"XhfB","./ar-kw.js":"XhfB","./ar-ly":"xL0N","./ar-ly.js":"xL0N","./ar-ma":"Km7B","./ar-ma.js":"Km7B","./ar-sa":"pjaK","./ar-sa.js":"pjaK","./ar-tn":"kiqk","./ar-tn.js":"kiqk","./ar.js":"IOJo","./az":"ZG5g","./az.js":"ZG5g","./be":"bOOT","./be.js":"bOOT","./bg":"+4Ma","./bg.js":"+4Ma","./bm":"5DAm","./bm.js":"5DAm","./bn":"k9jZ","./bn.js":"k9jZ","./bo":"bDV2","./bo.js":"bDV2","./br":"yANP","./br.js":"yANP","./bs":"HbKM","./bs.js":"HbKM","./ca":"Hy8E","./ca.js":"Hy8E","./cs":"Yne1","./cs.js":"Yne1","./cv":"0IPV","./cv.js":"0IPV","./cy":"iXAN","./cy.js":"iXAN","./da":"JzsT","./da.js":"JzsT","./de":"bA62","./de-at":"vBMD","./de-at.js":"vBMD","./de-ch":"eBaC","./de-ch.js":"eBaC","./de.js":"bA62","./dv":"ka8z","./dv.js":"ka8z","./el":"p2gm","./el.js":"p2gm","./en-au":"5x4g","./en-au.js":"5x4g","./en-ca":"GcKt","./en-ca.js":"GcKt","./en-gb":"XWHh","./en-gb.js":"XWHh","./en-ie":"WUyd","./en-ie.js":"WUyd","./en-il":"pJZv","./en-il.js":"pJZv","./en-nz":"WSyE","./en-nz.js":"WSyE","./eo":"7YTr","./eo.js":"7YTr","./es":"bZ1w","./es-do":"BxDi","./es-do.js":"BxDi","./es-us":"4caD","./es-us.js":"4caD","./es.js":"bZ1w","./et":"ob/G","./et.js":"ob/G","./eu":"bYU1","./eu.js":"bYU1","./fa":"pLxM","./fa.js":"pLxM","./fi":"nWxF","./fi.js":"nWxF","./fo":"ZiQj","./fo.js":"ZiQj","./fr":"sVpL","./fr-ca":"kPL3","./fr-ca.js":"kPL3","./fr-ch":"RNA7","./fr-ch.js":"RNA7","./fr.js":"sVpL","./fy":"PB2Q","./fy.js":"PB2Q","./gd":"e2YH","./gd.js":"e2YH","./gl":"A0mo","./gl.js":"A0mo","./gom-latn":"NmY5","./gom-latn.js":"NmY5","./gu":"3Wa/","./gu.js":"3Wa/","./he":"0XU1","./he.js":"0XU1","./hi":"Vwvj","./hi.js":"Vwvj","./hr":"pcBC","./hr.js":"pcBC","./hu":"D5Ns","./hu.js":"D5Ns","./hy-am":"tkzS","./hy-am.js":"tkzS","./id":"MC2+","./id.js":"MC2+","./is":"iBvB","./is.js":"iBvB","./it":"o7/M","./it.js":"o7/M","./ja":"CxcX","./ja.js":"CxcX","./jv":"KrDx","./jv.js":"KrDx","./ka":"v1/e","./ka.js":"v1/e","./kk":"3C/K","./kk.js":"3C/K","./km":"eXR7","./km.js":"eXR7","./kn":"c++O","./kn.js":"c++O","./ko":"hndj","./ko.js":"hndj","./ky":"1AGL","./ky.js":"1AGL","./lb":"iYlu","./lb.js":"iYlu","./lo":"hxGK","./lo.js":"hxGK","./lt":"murZ","./lt.js":"murZ","./lv":"UcDz","./lv.js":"UcDz","./me":"cLAB","./me.js":"cLAB","./mi":"HF3F","./mi.js":"HF3F","./mk":"78aY","./mk.js":"78aY","./ml":"gBwJ","./ml.js":"gBwJ","./mn":"bNfB","./mn.js":"bNfB","./mr":"+DOK","./mr.js":"+DOK","./ms":"3n2v","./ms-my":"I7lm","./ms-my.js":"I7lm","./ms.js":"3n2v","./mt":"3LCO","./mt.js":"3LCO","./my":"F9vK","./my.js":"F9vK","./nb":"JOSY","./nb.js":"JOSY","./ne":"xL/3","./ne.js":"xL/3","./nl":"t7fg","./nl-be":"2Kpe","./nl-be.js":"2Kpe","./nl.js":"t7fg","./nn":"uS6b","./nn.js":"uS6b","./pa-in":"4ptT","./pa-in.js":"4ptT","./pl":"XsyX","./pl.js":"XsyX","./pt":"lXCk","./pt-br":"5xvq","./pt-br.js":"5xvq","./pt.js":"lXCk","./ro":"eQHX","./ro.js":"eQHX","./ru":"w3S3","./ru.js":"w3S3","./sd":"SyUM","./sd.js":"SyUM","./se":"Kijy","./se.js":"Kijy","./si":"49SZ","./si.js":"49SZ","./sk":"IhTt","./sk.js":"IhTt","./sl":"fmHV","./sl.js":"fmHV","./sq":"oC5X","./sq.js":"oC5X","./sr":"eK7V","./sr-cyrl":"gxAT","./sr-cyrl.js":"gxAT","./sr.js":"eK7V","./ss":"A8qF","./ss.js":"A8qF","./sv":"5U3I","./sv.js":"5U3I","./sw":"OID1","./sw.js":"OID1","./ta":"cm8n","./ta.js":"cm8n","./te":"c0DL","./te.js":"c0DL","./tet":"NIrx","./tet.js":"NIrx","./tg":"l7ge","./tg.js":"l7ge","./th":"TFol","./th.js":"TFol","./tl-ph":"8Mf3","./tl-ph.js":"8Mf3","./tlh":"q23S","./tlh.js":"q23S","./tr":"224B","./tr.js":"224B","./tzl":"BgS5","./tzl.js":"BgS5","./tzm":"gpr6","./tzm-latn":"Al6r","./tzm-latn.js":"Al6r","./tzm.js":"gpr6","./ug-cn":"XDTV","./ug-cn.js":"XDTV","./uk":"6OdZ","./uk.js":"6OdZ","./ur":"TuDG","./ur.js":"TuDG","./uz":"3Zp5","./uz-latn":"nuOY","./uz-latn.js":"nuOY","./uz.js":"3Zp5","./vi":"xxt/","./vi.js":"xxt/","./x-pseudo":"H27D","./x-pseudo.js":"H27D","./yo":"RG4E","./yo.js":"RG4E","./zh-cn":"m+PY","./zh-cn.js":"m+PY","./zh-hk":"/tEC","./zh-hk.js":"/tEC","./zh-tw":"fq3i","./zh-tw.js":"fq3i"};r.keys=function(){return Object.keys(a)},r.resolve=s,t.exports=r,r.id="rHti"},"rN+S":function(t,e){t.exports='<div mat-dialog-content>\r\n  <mat-card>\r\n    <mat-card-title>\r\n      <h4>Are you sure want to return this map?</h4>\r\n    </mat-card-title>\r\n    <mat-card-subtitle>If you are Field Service Group overseer or you are assigned to take a group, consider reusing this map.</mat-card-subtitle>\r\n    <mat-card-actions>\r\n      <button mat-raised-button color="accent" (click)="data.consumer.returnMap()">Yes</button>\r\n      <button mat-raised-button color="accent" (click)="data.consumer.closeConfirmDlg()">No</button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n'},wINU:function(t,e,n){"use strict";var r=n("/oeL"),s=n("GsmQ"),a=n("Dqrr"),o=(n.n(a),n("p5Ee")),i=n("6lRS"),d=n("xrDH"),c=(n.n(d),n("BkNc")),u=n("Dcui"),p=n("HGbW"),l=n("0+Pn"),m=n("fc+i"),h=n("SAdc"),f=n("PMtK"),g=n.n(f);n.d(e,"a",function(){return O}),n.d(e,"d",function(){return A}),n.d(e,"b",function(){return j}),n.d(e,"c",function(){return w});var b=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},v=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},M=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},O=function(t){function e(e,n,s,a,o,i,d){var c=t.call(this)||this;return c.mapService=e,c.route=a,c.winRef=o,c.currentLocation={addObj:{clat:null,clang:null},iconUrl:"/assets/images/my_location_1.svg",pushed:!1},c.points=[],c.centerLat=-27.5518075,c.centerLng=153.0807544,c.zoom=13,c.height="700px",c.heightPadding=50,c.maxWaitTries=20,c.maxWaitCtr=0,c.sameCtr=0,c.sameMax=10,c.checkInterval=1e3,c.showInfo=!1,c.onToggleShowInfo=new r.EventEmitter,c.onComplete=new r.EventEmitter,c.onAddressClick=new r.EventEmitter,c.onAddLocMarker=new r.EventEmitter,c.onPosMarker=new r.EventEmitter,c.onMarkerLoad=new r.EventEmitter,c.onFit=new r.EventEmitter,c.minimumClusterSize=2,c.shortenTitleWidth=1024,c.triggerUpdate=!1,c.mapStarted=!1,c.showLocation=!1,c.locationSearching=!1,c.EDIT_MODE_STATUS="editStatus",c.EDIT_MODE_ADDRESS="editAddress",c.EDIT_MODE_MOVE_ADDRESS="moveAddress",c.EDIT_MODE_NEED_ADDRESS="needAddress",c.statusCache=[],c.ADDRESS_UNSELECTED_ICON="/assets/images/place-markers/home-unselected.svg",c.ADDRESS_SELECTED_ICON="/assets/images/place-markers/home-selected.svg",c.selectedAddrMarkers=[],c.selectedAddresses=[],c.lastSelectedAddress=null,c.findMapId=null,c.targetMapId=null,c.targetMapObj=null,c.mapBin={},c.mapIds=[],c.dialog=n,c.fireAuth=s,o.redirHttps(),c.requireLogin(),i.addSvgIcon("fit-map",d.bypassSecurityTrustResourceUrl("/assets/images/fitmap.svg")),i.addSvgIcon("add-address",d.bypassSecurityTrustResourceUrl("/assets/images/add_address.svg")),c.editMode=c.EDIT_MODE_STATUS,c}return b(e,t),e.prototype.setEditingAddress=function(){this.editMode=this.EDIT_MODE_ADDRESS},e.prototype.isEditModeAddress=function(){return this.editMode==this.EDIT_MODE_ADDRESS},e.prototype.setEditModeMoveAddress=function(){this.editMode=this.EDIT_MODE_MOVE_ADDRESS},e.prototype.isEditModeMoveAddress=function(){return this.editMode==this.EDIT_MODE_MOVE_ADDRESS},e.prototype.setEditingStatus=function(){this.editMode=this.EDIT_MODE_STATUS},e.prototype.isEditStatus=function(){return this.editMode==this.EDIT_MODE_STATUS},e.prototype.isEditModeNeedAddress=function(){return this.editMode==this.EDIT_MODE_NEED_ADDRESS},e.prototype.adjustHeight=function(){this.numHeight=this.winRef.nativeWindow.innerHeight-this.heightPadding,this.height=this.numHeight+"px"},e.prototype.postLoginSetup=function(){var t=this;console.log(this.winRef.nativeWindow.innerHeight),this.adjustHeight(),this.mapId?console.log("Post login set up triggered, already loaded, doing nothing."):(this.title="Loading...",this.subs.push(this.route.params.subscribe(function(e){t.mapId=e.id,t.mapService.getMetadata().subscribe(function(e){t.loadMaps(),t.loadPreferences()})})))},e.prototype.loadPreferences=function(){var t=this;this.fireAuth.getUserInfo(this.fireAuth.currentUser).subscribe(function(e){if(e.userInfoObj.geo){var n=new r.EventEmitter,s=null;n.subscribe(function(e){var n=g()();null!=s&&n.isBefore(s.add(1,"minute"))||(s=n,t.fireAuth.saveLoc(t.fireAuth.currentUser.userObj.uid,e))}),t.mapService.enableGeolocation(n)}t.fireAuth.saveOnlineStat(t.fireAuth.currentUser)})},e.prototype.ngOnDestroy=function(){this.clearMaps(),this.unsubscribeAll()},e.prototype.toggleShowInfo=function(){this.showInfo=!this.showInfo,console.log("Emitting: "+this.showInfo),this.onToggleShowInfo.emit(this.showInfo)},e.prototype.toggleShowLocation=function(){this.showLocation=!this.showLocation,this.showLocation?this.showCurrentLoc():this.mapService.disableGeolocation(this.onPosMarker)},e.prototype.fitMap=function(){this.onFit.emit({})},e.prototype.accessDenied=function(){this.title="Access Denied",this.hideLoadingDialog(),this.notifyDlg=this.dialog.open(h.b,{data:{consumer:this,title:"Access denied",subtitle:"You don't have privileges to access this page. If you think you should have access, please contact the administrator.",confirmText:"Go Home"},disableClose:!0})},e.prototype.confirmNotification=function(){this.notifyDlg.close(),this.winRef.location("/home")},e.prototype.saveAddressEdit=function(){var t=this;this.mapService.saveAddr([this.selectedAddObj],"all"==this.mapId?null:this.currentMap,null,function(){t.selectedAddObj=null,t.closeAddrDlg(),t.resetEditMode()})},e.prototype.startMoveAddressMode=function(){var t=this;this.setEditModeMoveAddress(),d.each(this.points,function(e){t.statusCache.push(e.marker.icon.url),e.marker.icon.url=t.ADDRESS_UNSELECTED_ICON}),this.mapService.triggerUpdate()},e.prototype.stopMoveAddressMode=function(){var t=this;this.resetEditMode(),d.each(this.points,function(e,n){e.marker.icon.url=t.statusCache[n]}),this.statusCache=[],this.selectedAddresses=[],this.selectedAddrMarkers=[],this.mapService.triggerUpdate()},e.prototype.addNewAddressMode=function(){this.selectedAddObj={unit:"",hnum:"",st:"",burb:"",clat:"",clong:"",pcode:"",tel:""},this.setEditingAddress(),this.showAddrDlg()},e.prototype.enableEditAddress=function(){if(this.isEditModeAddress())if(this.hasMultiAdds())this.selectedAddObj=d.map(this.currentAddr.addObj,function(t){var e=d.clone(t);e.addId=t.$key,(d.isUndefined(e.unit)||-9==e.unit)&&(e.unit="")});else{var t=d.isArray(this.currentAddr.addObj)&&this.selectedAddObj?d.clone(this.selectedAddObj):d.clone(this.currentAddr.addObj);t.addId=d.isArray(this.currentAddr.addObj)&&this.selectedAddObj?this.selectedAddObj.$key:this.currentAddr.addObj.$key,(d.isUndefined(t.unit)||-9==t.unit)&&(t.unit=""),this.selectedAddObj=t}console.log(this.selectedAddObj),this.showAddrDlg()},e.prototype.loadMaps=function(){var t=this;if(!d.isEmpty(this.points))return void console.log("Maps already loaded");var e=o.a.app.mapBase;if(this.showLoadingDialog(),"all"!=this.mapId)return void this.loadSingleMap(e);if(this.setEditingAddress(),!this.fireAuth.currentUser.isAdmin()&&!this.fireAuth.currentUser.isUpdater())return void this.accessDenied();this.mapService.loadAllMapsWithMarkers(e);var n=a.Observable.interval(this.checkInterval).subscribe(function(e){t.mapService.mapMarkers.length!=t.curPointsCtr?(t.curPointsCtr=t.mapService.mapMarkers.length,t.sameCtr=0):(t.maxWaitCtr++,t.sameCtr++,(t.maxWaitCtr>t.maxWaitTries||t.sameCtr>t.sameMax)&&(console.log("Got all addresses, rendering..."),console.log("Total no. maps: "+t.mapService.maps.length),console.log("Total no. of addresses: "+t.mapService.mapMarkers.length),t.points=t.mapService.mapMarkers,n.unsubscribe(),t.hideLoadingDialog(),t.mapService.trackUpdates=!0,t.onComplete.emit({}),t.triggerUpdate&&t.mapService.triggerUpdate(),t.mapService.maps.length>1?"all"==t.mapId&&(t.title="All Maps"):t.setTitle(),t.subs.push(t.onAddressClick.subscribe(function(e){console.log(e),t.currentAddr=e.addrMarker,t.handleAddressClick()}))))})},e.prototype.setTitle=function(){this.title=this.mapService.maps[0].terId+" - "+this.mapService.maps[0].name+" "+(this.mapService.isNormalMode()?"":"::Campaign"),this.winRef.nativeWindow.innerWidth<=this.shortenTitleWidth&&(this.title="Map "+this.mapService.maps[0].terId+(this.mapService.isNormalMode()?"":"::Campaign"))},e.prototype.canOpenMap=function(t){return this.fireAuth.currentUser&&(t.isUser(this.fireAuth.currentUser)||this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e.prototype.deleteMap=function(){var t=this;confirm("Are you sure you want to permanently delete this map and all the addresses?")&&(d.isUndefined(this.fsgs)?this.getMapFsgData(function(){t.showLoadingDialog(),t.mapService.deleteMap(t.currentMap.mapObj.$key,t.mapKey,t.fsgName,t.currentMap.addresses,function(){t.hideLoadingDialog(),t.winRef.nativeWindow.location="/home"})}):(this.showLoadingDialog(),this.mapService.deleteMap(this.currentMap.mapObj.$key,this.mapKey,this.fsgName,this.currentMap.addresses,function(){t.hideLoadingDialog(),t.winRef.nativeWindow.location="/home"})))},e.prototype.editAddress=function(t,e){t.preventDefault();var n=null;d.each(this.points,function(t){if(d.find(t.addId,function(t){return t==e.addId}))return n=t,!1}),n&&(this.currentAddr=n,this.selectedAddObj=e,this.closeAddrListDlg(),this.setEditingAddress(),this.enableEditAddress())},e.prototype.deleteAddress=function(t,e){var n=this;t.preventDefault(),confirm("Are you sure you want to delete: "+e.hnum+" "+e.st+" ?")&&this.mapService.deleteAddress(e.addId,e.mapAddrKey,e.mapId,function(){d.remove(n.currentAddrList,function(t){return t.addId===e.addId})})},e.prototype.loadSingleMap=function(t){var e=this;this.minimumClusterSize=200,this.subs.push(this.mapService.loadMapMarkersObs(t,this.mapId).catch(function(t,n){return console.log("Error loading map:"),console.log(t),t===e.mapService.errorMap.NO_ADDRESS&&(e.editMode=e.EDIT_MODE_NEED_ADDRESS,e.currentMap=new s.b(e.mapId,e.mapService.maps[e.mapService.maps.length-1],null),e.title=e.currentMap.mapObj.name+"  - No addresses"),e.hideLoadingDialog(),a.Observable.of(null)}).subscribe(function(t){if(t){if(console.log("Map: "),console.log(t),!e.canOpenMap(t))return void e.accessDenied();e.editMode==e.EDIT_MODE_NEED_ADDRESS&&(e.editMode=e.EDIT_MODE_STATUS),e.mapStarted=t.assgnObj.$exists()&&!d.isEmpty(t.assgnObj.started),t.addresses=d.sortBy(t.addresses,[function(t){return d.isUndefined(t.lSt)||d.isNull(t.lSt)?d.toLower(t.st):t.lSt},function(t){return d.toSafeInteger(t.hnum)},function(t){return t.unit&&-9!=t.unit?d.toSafeInteger(t.unit):0}]),e.currentMap=t,e.currentAddrList&&(e.currentAddrList=d.cloneDeep(e.currentMap.addresses)),e.mapService.createMarkersWithStatus(t),e.points=e.mapService.mapMarkers,e.mapService.trackUpdates=!0,e.onComplete.emit({}),e.triggerUpdate&&e.mapService.triggerUpdate(),e.setTitle();var n=e.fireAuth.currentUser&&e.fireAuth.currentUser.userInfoObj?e.fireAuth.currentUser.userInfoObj.name:"",r=e.mapService.maps[0].terId;e.addUrl=o.a.addressFeedBackForm+"?usp=pp_url&entry.1810388592=Yes&entry.1189370340=&entry.45257833&entry.681741514="+r+"&entry.1482719893="+n+"&entry.1683213160=%E6%98%AF&entry.293956968=&entry.602343366&entry.2071713990="+r+"&entry.138422963="+n+"&entry.1018422546&entry.2060338072&entry.1052547294&entry.365006055&entry.1323592748="+r+"&entry.1534052334="+n+"&entry.1011916189&entry.1303192619&entry.825337910&entry.1931492709&entry.2023645450="+r+"&entry.913416032="+n,e.hideLoadingDialog(),e.triggerUpdate=!0,e.subs.push(e.onAddressClick.subscribe(function(t){console.log(t),e.currentAddr=t.addrMarker,e.handleAddressClick()}))}}))},e.prototype.handleAddressClick=function(){var t=this;if(this.isEditModeAddress()||this.isEditStatus()){if(this.addrDlg)return;this.hasMultiAdds()?(this.currentAddrTitle="Multiple addresses, select one below.",this.currentGmapUrl=null,this.selectedAddObj=null,console.log(this.currentAddr)):(this.currentAddrTitle=this.getAddressTitle(this.currentAddr.addObj),this.currentGmapUrl=this.getGmapUrl(this.currentAddr.addObj),this.selectedAddObj=this.currentAddr.addObj,d.isUndefined(this.selectedAddObj.status)&&(this.selectedAddObj.status=0),this.buildFeedbackUrl()),this.showAddrDlg()}else if(this.isEditModeMoveAddress()){if(this.lastSelectedAddress==this.currentAddr)return void(this.lastSelectedAddress=null);this.lastSelectedAddress=this.currentAddr,this.currentAddr.marker.icon.url==this.ADDRESS_SELECTED_ICON?(this.currentAddr.marker.icon.url=this.ADDRESS_UNSELECTED_ICON,d.remove(this.selectedAddrMarkers,function(e){return d.isEqual(e,t.currentAddr)})):(this.currentAddr.marker.icon.url=this.ADDRESS_SELECTED_ICON,this.selectedAddrMarkers.push(this.currentAddr),this.lastSelectedAddress=null),this.selectedAddresses=[],d.each(this.selectedAddrMarkers,function(e){d.isArray(e.addObj)?d.each(e.addObj,function(e){t.selectedAddresses.push(e)}):t.selectedAddresses.push(e.addObj)}),this.mapService.triggerUpdate(),this.adjustHeight(),console.log(this.selectedAddresses)}},e.prototype.findTargetMap=function(){var t=this;this.mapService.findByTerId(this.findMapId,function(e){e&&d.forOwn(e,function(e,n){t.targetMapId=n,t.targetMapObj=e})})},e.prototype.moveSelectedAddresses=function(){var t=this;console.log("Moving to "+this.targetMapId),console.log(this.targetMapObj),this.mapService.moveAddress(this.mapId,this.targetMapId,this.targetMapObj.terId,this.targetMapObj.name,this.targetMapObj.fsg,this.selectedAddresses,function(){var e=t.selectedAddrMarkers;t.stopMoveAddressMode(),console.log("Removing..."),console.log(e),console.log(t.points),d.remove(t.points,function(t){return d.includes(e,t)}),console.log(t.points),t.mapService.triggerUpdate()})},e.prototype.startMap=function(t){},e.prototype.isNotAtHome=function(){return this.currentAddr&&3==this.currentAddr.map.getStatus(this.currentAddr.addId)},e.prototype.hasDetail=function(){return this.currentAddr&&this.currentAddr.map.getStatusDetail(this.currentAddr.addId)},e.prototype.getLastVisited=function(){var t=this.currentAddr.map.getStatusDetail(this.currentAddr.addId);return t?t.nh_when:null},e.prototype.getAddressTitle=function(t){if(d.isUndefined(t.st)||d.isEmpty(t.st))return"";var e=t.unit;return d.isUndefined(e)||!e||"-9"==""+e?e="":e+="/",""+e+t.hnum+" "+t.st+", "+t.burb},e.prototype.getGmapUrl=function(t){return"https://www.google.com/maps/dir/?api=1&destination="+t.hnum+" "+t.st+", "+t.burb+"&travelmode=driving"},e.prototype.getStatuses=function(){this.addrStatuses||(this.addrStatuses=this.currentMap.getAddrStatuses(this.fireAuth.currentUser,this.mapService))},e.prototype.showAddrDlg=function(){console.log(this.points),"all"!=this.mapId&&this.getStatuses(),console.log("Opening dialog..."),this.addrDlg&&this.closeAddrDlg(),this.addrDlg=this.dialog.open(j,{data:{consumer:this},disableClose:!0})},e.prototype.closeAddrDlg=function(){console.log("Closing dialog..."),this.dialog.closeAll(),this.addrDlg=null},e.prototype.resetEditMode=function(){"all"==this.mapId?this.setEditingAddress():this.editMode==this.EDIT_MODE_NEED_ADDRESS||this.setEditingStatus()},e.prototype.cancelAddrDlg=function(){this.closeAddrDlg(),this.resetEditMode(),this.selectedAddObj=null},e.prototype.showCurrentLoc=function(){var t=this;this.onPosMarker.subscribe(function(e){t.locationSearching&&(t.locationSearching=!1),e?(t.onAddLocMarker.emit({position:e.position,iconUrl:t.currentLocation.iconUrl}),t.fireAuth.saveLoc(t.fireAuth.currentUser.userObj.uid,e)):t.onAddLocMarker.emit(null)}),this.mapService.enableGeolocation(this.onPosMarker)},e.prototype.clearMaps=function(){this.mapService.clearAllMarkers(),this.currentLocation.pushed=!1},e.prototype.showMarker=function(){this.clearMaps()},e.prototype.logout=function(){this.clearMaps(),t.prototype.logout.call(this),this.triggerUpdate=!0},e.prototype.isAdmin=function(){return this.fireAuth.currentUser&&this.fireAuth.currentUser.isAdmin()},e.prototype.isUpdater=function(){return this.fireAuth.currentUser&&(this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e.prototype.onStatusChange=function(t){},e.prototype.saveStatus=function(){var t=this,e=this.currentAddr.mapObj.$key,n=this.selectedAddObj.$key,r=this.selectedAddObj.status;this.selectedAddObj;this.closeAddrDlg(),this.showLoadingDialog(),console.log("Status: "+r),this.mapService.updateAddrStat(e,n,r,this.fireAuth.currentUser,function(e,n,r){console.log("Manulaly setting Status: "+n),t.currentAddr.map.setStatus(e,n),t.currentAddr.map.setStatusDetail(e,r),t.selectedAddObj=null})},e.prototype.saveStatuses=function(){var t=this;this.currentMap.addresses=this.currentAddrList,this.closeAddrListDlg(),this.showLoadingDialog(),this.mapService.updateAddrStats(this.currentMap,this.fireAuth.currentUser,function(e){d.each(e.addresses,function(e){var n=e.status,r=e.$key;t.currentMap.setStatus(r,n)}),t.hideLoadingDialog()})},e.prototype.hasMultiAdds=function(){return this.currentAddr&&d.isArray(this.currentAddr.addObj)&&!this.selectedAddObj},e.prototype.selectAdd=function(t){this.currentAddrTitle=this.getAddressTitle(t),this.currentGmapUrl=this.getGmapUrl(t),this.selectedAddObj=t,this.buildFeedbackUrl()},e.prototype.buildFeedbackUrl=function(){var t=this.fireAuth.currentUser&&this.fireAuth.currentUser.userInfoObj?this.fireAuth.currentUser.userInfoObj.name:"",e=this.mapService.maps[0].terId;this.currentFeedbackUrl="https://docs.google.com/forms/d/e/1FAIpQLSdZYe2BmeJ_DLwW1lbvu9bcLWe7_wZ3Rs5fdaw-q4g9zfys3g/viewform?usp=pp_url&entry.1810388592=No&entry.1189370340="+this.currentAddrTitle+"&entry.45257833&entry.681741514="+e+"&entry.1482719893="+t+"&entry.1683213160=%E4%B8%8D%E6%98%AF&entry.293956968="+this.currentAddrTitle+"&entry.602343366&entry.2071713990="+e+"&entry.138422963="+t+"&entry.1018422546&entry.2060338072&entry.1052547294&entry.365006055&entry.1323592748="+e+"&entry.1534052334="+t+"&entry.1011916189&entry.1303192619&entry.825337910&entry.1931492709&entry.2023645450="+e+"&entry.913416032="+t},e.prototype.viewList=function(){this.getStatuses(),this.currentAddrList=d.cloneDeep(this.currentMap.addresses),this.addrListDlg=this.dialog.open(w,{data:{consumer:this},disableClose:!0})},e.prototype.closeAddrListDlg=function(){this.addrListDlg.close(),this.currentAddrList=null},e.prototype.getAddressTitleWithStatus=function(t){var e=this.getAddressTitle(t);return t.status&&(e=this.getStatusLabel(t.status)+" - "+e),e},e.prototype.getStatusLabel=function(t){var e="Not Done";return d.isUndefined(t.status)||d.forEach(this.addrStatuses,function(n){t.status==n.val&&(e=n.label)}),e},e.prototype.getStatus=function(t){return(d.isUndefined(t.status)||d.isNull(t.status))&&(t.status=0),t},e.prototype.getStatusBgColor=function(t,e){void 0===e&&(e=null);var n="#960202",r=t?t.status:e;if(!d.isUndefined(r))switch(r){case 1:case 9:n="#428214";break;case 2:n="#401804";break;case 3:n="#e88017";break;case 4:n="#8d57c2";break;case 5:n="#4a5963";break;case 7:case 8:n="#227874";break;case 10:n="#f2046f"}return n},e.prototype.getStatusFgColor=function(t,e){void 0===e&&(e=null);var n="#000000",r=t?t.status:e;if(!d.isUndefined(r))switch(r){case 0:case 2:n="#ffffff"}return n},e.prototype.getMapFsgData=function(t){var e=this;this.showLoadingDialog();var n=this.mapService.getAllFsgMaps(this.mapBin).flatMap(function(t){return a.Observable.of(null)}).debounce(function(){return a.Observable.interval(1e3)}).subscribe(function(){n.unsubscribe(),d.forOwn(e.mapBin,function(t,n){e.mapIds.push(t)}),e.fsgs=d.uniq(d.map(e.mapIds,function(t){return t.fsgName})),e.mapName=e.currentMap.mapObj.name,e.fsgName=e.currentMap.mapObj.fsg,e.mapKey=e.mapBin[e.mapId].mapKey,e.hideLoadingDialog(),t()})},e.prototype.editMap=function(){var t=this;d.isUndefined(this.fsgs)?this.getMapFsgData(function(){t.mapEditDlg=t.dialog.open(A,{data:{consumer:t},disableClose:!0})}):(this.mapName=this.currentMap.mapObj.name,this.fsgName=this.currentMap.mapObj.fsg,this.mapKey=this.mapBin[this.mapId].mapKey,this.mapEditDlg=this.dialog.open(A,{data:{consumer:this},disableClose:!0}))},e.prototype.saveMapEdit=function(){var t=this;this.closeMapEditDlg(),this.showLoadingDialog(),this.mapService.moveMap(this.mapId,this.mapKey,this.mapName,this.currentMap.mapObj.fsg,this.fsgName,function(){t.currentMap.mapObj.fsg=t.fsgName,t.currentMap.mapObj.name=t.mapName,t.mapBin[t.mapId].mapKey=t.mapId,t.title=t.currentMap.mapObj.terId+" - "+t.currentMap.mapObj.name+" "+(t.mapService.isNormalMode()?"":"::Campaign"),t.hideLoadingDialog()})},e.prototype.closeMapEditDlg=function(){this.mapEditDlg.close()},e}(p.a);y([n.i(r.ViewChild)("markerCluster"),v("design:type","function"==typeof(_=void 0!==r.ElementRef&&r.ElementRef)&&_||Object)],O.prototype,"markerClusterRef",void 0),O=y([n.i(r.Component)({selector:"map-component",template:n("3CHR"),styles:[n("KJMk")]}),v("design:paramtypes",["function"==typeof(S=void 0!==s.a&&s.a)&&S||Object,"function"==typeof(I=void 0!==i.b&&i.b)&&I||Object,"function"==typeof(k=void 0!==l.a&&l.a)&&k||Object,"function"==typeof(x=void 0!==c.b&&c.b)&&x||Object,"function"==typeof(D=void 0!==u.a&&u.a)&&D||Object,"function"==typeof(C=void 0!==i.e&&i.e)&&C||Object,"function"==typeof(U=void 0!==m.d&&m.d)&&U||Object])],O);var A=function(){function t(t,e,n,r){this.dialogRef=t,this.data=e,n.addSvgIcon("google-map",r.bypassSecurityTrustResourceUrl("/assets/images/google-maps.svg")),n.addSvgIcon("edit-address",r.bypassSecurityTrustResourceUrl("/assets/images/edit_address.svg"))}return t}();A=y([n.i(r.Component)({selector:"map-edit-component",template:n("5OgQ")}),M(1,n.i(r.Inject)(i.c)),v("design:paramtypes",["function"==typeof(L=void 0!==i.d&&i.d)&&L||Object,Object,"function"==typeof(E=void 0!==i.e&&i.e)&&E||Object,"function"==typeof(R=void 0!==m.d&&m.d)&&R||Object])],A);var j=function(){function t(t,e,n,r){this.dialogRef=t,this.data=e,n.addSvgIcon("google-map",r.bypassSecurityTrustResourceUrl("/assets/images/google-maps.svg")),n.addSvgIcon("edit-address",r.bypassSecurityTrustResourceUrl("/assets/images/edit_address.svg"))}return t}();j=y([n.i(r.Component)({selector:"addr-component",template:n("Z/XM")}),M(1,n.i(r.Inject)(i.c)),v("design:paramtypes",["function"==typeof(P=void 0!==i.d&&i.d)&&P||Object,Object,"function"==typeof(T=void 0!==i.e&&i.e)&&T||Object,"function"==typeof(N=void 0!==m.d&&m.d)&&N||Object])],j);var w=function(){function t(t,e,n,r){this.dialogRef=t,this.data=e}return t}();w=y([n.i(r.Component)({selector:"addrlist-component",template:n("cukb")}),M(1,n.i(r.Inject)(i.c)),v("design:paramtypes",["function"==typeof(B=void 0!==i.d&&i.d)&&B||Object,Object,"function"==typeof(F=void 0!==i.e&&i.e)&&F||Object,"function"==typeof(z=void 0!==m.d&&m.d)&&z||Object])],w);var _,S,I,k,x,D,C,U,L,E,R,P,T,N,B,F,z},wQAS:function(t,e,n){"use strict";var r=n("/oeL");n.d(e,"a",function(){return a});var s=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},a=function(){function t(){}return t}();a=s([n.i(r.Component)({selector:"app-root",template:n("efyd"),styles:[n("hxJY")]})],a)},xwLn:function(t,e,n){"use strict";var r=n("/oeL"),s=n("a0oU"),a=n("Dqrr"),o=(n.n(a),n("xrDH")),i=(n.n(o),n("Xir+"));n.n(i);n.d(e,"a",function(){return u});var d=this&&this.__decorate||function(t,e,n,r){var s,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var i=t.length-1;i>=0;i--)(s=t[i])&&(o=(a<3?s(o):a>3?s(e,n,o):s(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t){this.gmapsApi=t,this.markers=[],this.maxTypeIdx=3,this.maxColorIdx=3,this.markerIcons=[],this.hasLoaded=!1,this.style={url:"/assets/images/place-markers/cluster.png",height:40,width:40,textColor:"#FFF",textSize:11,backgroundPosition:"center center"},this.options={imagePath:"/assets/images/place-markers/cluster",gridSize:20,minimumClusterSize:2,styles:[this.style,this.style,this.style]},this.minimumClusterSize=2}return t.prototype.ngOnInit=function(){var t=this;this.onUpdate.subscribe(function(e){t.clearMarkers(),t.loadPoints()}),this.onSetShowClusterInfo.subscribe(function(e){t.markerCluster.setShowInfo(e)}),this.onFit&&this.onFit.subscribe(function(e){t.fitBounds()}),this.onClear&&this.onClear.subscribe(function(e){t.clearMarkers()}),this.onAddLocMarker&&this.onAddLocMarker.subscribe(function(e){t.gmapsApi.getNativeMap().then(function(n){if(t.resetBounds(),t.locationMarker)if(e){var r=new google.maps.LatLng(e.position.lat,e.position.lng);t.locationMarker.setPosition(r),t.bounds.extend(t.locationMarker.getPosition())}else t.locationMarker.setMap(null),t.locationMarker=null;else t.locationMarker=new google.maps.Marker({position:e.position,map:n,icon:e.iconUrl,optimized:!1}),t.bounds.extend(t.locationMarker.getPosition())})})},t.prototype.resetBounds=function(){var t=this;this.bounds=new google.maps.LatLngBounds,o.forEach(this.markers,function(e){t.bounds.extend(e.getPosition())})},t.prototype.ngOnChanges=function(t){this.clearMarkers(),this.loadPoints()},t.prototype.loadPoints=function(){var t=this;if(!this.points||0==this.points.length)return console.log("No points to load..."),void this.onLoadComplete.emit(this);this.bounds=new google.maps.LatLngBounds,this.gmapsApi.getNativeMap().then(function(e){if(o.isEmpty(t.markerIcons)){t.scaledMarkerSize=new google.maps.Size(35,35);for(var n=0;n<=t.maxTypeIdx;n++)for(var r=0;r<=t.maxColorIdx;r++){var s="/assets/images/place-markers/pin-"+n+"-"+r+".svg";t.markerIcons.push({scaledSize:t.scaledMarkerSize,url:s})}}a.Observable.interval(500).skipWhile(function(e){return null==t.points||t.points.length<=0}).take(1).subscribe(function(){if(t.points.length>0){console.log("Painting markers...");for(var n=t.onAddressClick,r=0,s=t.points;r<s.length;r++){var a=s[r];!function(r){var s=new google.maps.Marker({position:new google.maps.LatLng(r.addObj.clat,r.addObj.clong),icon:t.markerIcons[r.markerIdx%t.markerIcons.length]});if(r.marker&&(s=r.marker),r.modalMode)s.addListener("click",function(){n.emit({gmap:e,gmarker:s,addrMarker:r})});else{var a='<div id="info-window">'+r.infoWindowStr+"</div>";s.infoWindowStr=r.infoWindowStr;var o=new google.maps.InfoWindow({content:a});s.addListener("click",function(){o.open(e,s)})}t.markers.push(s),t.bounds.extend(s.getPosition())}(a)}}else t.markers=[];t.options.minimumClusterSize=t.minimumClusterSize,t.markerCluster=new MarkerClusterer(e,t.markers,t.options),t.hasLoaded||(t.hasLoaded=!0,e.setCenter(t.bounds.getCenter()),e.fitBounds(t.bounds))})})},t.prototype.clearMarkers=function(){this.markerCluster&&(o.each(this.markers,function(t){google.maps.event.clearListeners(t,"click")}),this.markers=[],this.markerCluster.clearMarkers())},t.prototype.fitBounds=function(){var t=this;this.gmapsApi.getNativeMap().then(function(e){e.setCenter(t.bounds.getCenter()),e.fitBounds(t.bounds)})},t}();d([n.i(r.Input)(),c("design:type",Array)],u.prototype,"points",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(p=void 0!==r.EventEmitter&&r.EventEmitter)&&p||Object)],u.prototype,"onUpdate",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(l=void 0!==r.EventEmitter&&r.EventEmitter)&&l||Object)],u.prototype,"onFit",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(m=void 0!==r.EventEmitter&&r.EventEmitter)&&m||Object)],u.prototype,"onSetShowClusterInfo",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(h=void 0!==r.EventEmitter&&r.EventEmitter)&&h||Object)],u.prototype,"onClear",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(f=void 0!==r.EventEmitter&&r.EventEmitter)&&f||Object)],u.prototype,"onAddressClick",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(g=void 0!==r.EventEmitter&&r.EventEmitter)&&g||Object)],u.prototype,"onAddLocMarker",void 0),d([n.i(r.Input)(),c("design:type","function"==typeof(b=void 0!==r.EventEmitter&&r.EventEmitter)&&b||Object)],u.prototype,"onLoadComplete",void 0),d([n.i(r.Input)(),c("design:type",Array)],u.prototype,"markerIcons",void 0),d([n.i(r.Input)(),c("design:type",Object)],u.prototype,"style",void 0),d([n.i(r.Input)(),c("design:type",Object)],u.prototype,"options",void 0),d([n.i(r.Input)(),c("design:type",Number)],u.prototype,"minimumClusterSize",void 0),u=d([n.i(r.Directive)({selector:"marker-cluster"}),c("design:paramtypes",["function"==typeof(y=void 0!==s.b&&s.b)&&y||Object])],u);var p,l,m,h,f,g,b,y},zgAq:function(t,e){t.exports='<div style="text-align:center">\r\n  <h2>\r\n    {{ appTitle }}\r\n  </h2>\r\n</div>\r\n<div>\r\n  \x3c!-- <div class="flex-container"\r\n     fxLayout="row"\r\n     fxLayout.xs="row"\r\n     fxLayoutAlign="space-around none"\r\n     fxLayoutAlign.xs="start"> --\x3e\r\n     <mat-toolbar [ngClass]="\'bgc-blue-grey-900 whiteText marginTopBottom-2\'">\r\n        <userinfo></userinfo>\r\n        <span class="fill-remaining-space"></span>\r\n        <span><a style="margin-right: 5px;" mat-mini-fab [routerLink]="[\'/map/all\']" *ngIf="canViewAllMaps()"><mat-icon >map</mat-icon></a></span>\r\n        <span><a style="margin-right: 5px;" mat-mini-fab [routerLink]="[\'/mapadmin\']" *ngIf="canViewAllMaps()"><mat-icon >edit</mat-icon></a></span>\r\n        <span><a href="{{ addUrl }}" target="_blank" mat-mini-fab style="margin-right: 5px;"><mat-icon svgIcon="add-address"></mat-icon></a></span>\r\n        <span><a mat-mini-fab target="_blank" href="https://docs.google.com/document/d/1sNfzBlGop98HkbRW46PdGk0K2Hg8TLbHLkmysjLExKw/edit?usp=drive_web" ><mat-icon>help</mat-icon></a></span>\r\n        <user-admin></user-admin>\r\n     </mat-toolbar>\r\n   \x3c!-- </div> --\x3e\r\n  <mapslist-component #myMapsList></mapslist-component>\r\n</div>\r\n'}},[0]);